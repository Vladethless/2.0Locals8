!function(n,t,e){"use strict";function o(n){return S(!0,{},n||{})}function r(){var n=Array.prototype.slice,t=n.call(arguments,1);return n.apply(arguments[0],t)}function i(n){return"undefined"==typeof n}function u(t){return O.apply(n,t)}function a(n){return O().then(function(){return n})}function c(n,t){var e=Math,o=e.PI,r=o*n.lat()/180,i=o*n.lng()/180,u=o*t.lat()/180,a=o*t.lng()/180,c=e.cos,s=e.sin;return 6371e3*e.acos(e.min(c(r)*c(u)*c(i)*c(a)+c(r)*s(i)*c(u)*s(a)+s(r)*s(u),1))}function s(n){"loading"!=e.readyState?n():e.addEventListener("DOMContentLoaded",n)}function f(n){return v(n).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(n[t])}).join("&")}function p(n){return D[n]||(D[n]=l(n)),D[n]}function l(n){function t(n){return e.apply(this,n)}var e=E[n];return t.prototype=e.prototype,new t(r(arguments,1))}function g(n){var t=$();return"string"==typeof n&&(n={address:n}),p("Geocoder").geocode(n,function(n,e){e===E.GeocoderStatus.OK?t.resolve(n[0].geometry.location):t.reject(e)}),t}function d(n,t){h(n.split(" "),t)}function h(n,t){(R(n)?n:[n]).forEach(t)}function v(n){return Object.keys(n)}function y(n){return v(n).map(function(t){return n[t]})}function m(n,t){return n=o(n),n.bounds&&(n.bounds=P(n.bounds)),a(t(n))}function L(n,t,e){var r=$();return n=o(n),O().then(function(){var e=n.address;return e?(delete n.address,g(e).then(function(e){n[t]=e})):void(n[t]=x(n[t]))}).then(function(){r.resolve(e(n))}).fail(function(n){r.reject(n)}),r}function w(n,t,e){return n=o(n),n[t]=(n[t]||[]).map(x),a(e(n))}function x(n,t){return R(n)?new E.LatLng(n[0],n[1]):!t||!n||n instanceof E.LatLng?n:new E.LatLng(n.lat,n.lng)}function P(n,t){return R(n)?new E.LatLngBounds({lat:n[2],lng:n[3]},{lat:n[0],lng:n[1]}):t&&!n.getCenter?new E.LatLngBounds({lat:n.south,lng:n.west},{lat:n.north,lng:n.east}):n}function b(t,o){function r(){function n(n){return e.getProjection().fromLatLngToDivPixel(n)}var e=this,r=[];i.call(e),e.setMap(t),e.onAdd=function(){var n=e.getPanes();n.overlayMouseTarget.appendChild(u[0])},o.position?(e.getPosition=function(){return o.position},e.setPosition=function(n){o.position=n,e.draw()},e.draw=function(){var t=n(o.position);u.css({left:t.x+o.x+"px",top:t.y+o.y+"px"})}):(e.getBounds=function(){return o.bounds},e.setBounds=function(n){o.bounds=n,e.draw()},e.draw=function(){var t=n(o.bounds.getSouthWest()),e=n(o.bounds.getNorthEast());u.css({left:t.x+o.x+"px",top:e.y+o.y+"px",width:e.x-t.x+o.x+"px",height:t.y-e.y+o.y+"px"})}),e.onRemove=function(){r.map(function(n){E.event.removeListener(n)}),u.remove(),e.$=u=null},e.$=u}var i=E.OverlayView,u=n(e.createElement("div")).css({border:"none",borderWidth:0,position:"absolute"}).append(o.content);return o=S({x:0,y:0},o),o.position?o.position=x(o.position,!0):o.bounds&&(o.bounds=P(o.bounds,!0)),r.prototype=new i,new r}function M(n){function t(){var n=this;return n.onAdd=n.onRemove=n.draw=function(){},E.OverlayView.call(n)}t.prototype=new E.OverlayView;var e=new t;return e.setMap(n),e.getProjection()}function B(n,t,e,o){var r=this;r.cluster=n,r.markers=t,r.$=e.$,r.overlay=e,e.getBounds=function(){return l("LatLngBounds",o.getSouthWest(),o.getNorthEast())}}function C(n,t){function e(){var t=l("Circle",{center:n.getCenter(),radius:1.15*c(n.getCenter(),n.getBounds().getNorthEast())});return t.getBounds()}function i(n){var t=d.fromLatLngToDivPixel(n);return l("LatLngBounds",d.fromDivPixelToLatLng(l("Point",t.x-P,t.y+P)),d.fromDivPixelToLatLng(l("Point",t.x+P,t.y-P)))}function u(){var u,a,c,s,f,p,d=n.getZoom(),y={},x=[],P={};p=""+d,d>3&&(a=e(),h(w,function(n,t){a.contains(n.getPosition())||(p+="-"+t,P[t]=!0,n.getMap()&&n.setMap(null))})),m&&h(w,function(n,t){P[t]||m(n)||(p+="-"+t,P[t]=!0,n.getMap()&&n.setMap(null))}),p!==g&&(g=p,h(w,function(e,p){P[p]||(u=[p],a=i(e.getPosition()),C&&h(r(w,p+1),function(n,t){t+=p+1,!P[t]&&a.contains(n.getPosition())&&(u.push(t),P[t]=!0)}),s=u.join("-"),y[s]=!0,T[s]||(f=u.map(function(n){return w[n]}),c=t.cb(r(f)),c?(a=l("LatLngBounds"),h(f,function(n){a.extend(n.getPosition()),n.getMap()&&n.setMap(null)}),c=o(c),c.position=a.getCenter(),T[s]=new B(L,r(f),b(n,c),a),x.push(T[s])):h(f,function(t){t.getMap()||t.setMap(n)})))}),h(v(T),function(n){y[n]||(T[n].overlay.setMap(null),delete T[n])}),x.length&&h(k,function(n){n(x)}))}function a(){clearTimeout(f),f=setTimeout(u,100)}function s(){E.event.addListener(n,"zoom_changed",a),E.event.addListener(n,"bounds_changed",a),u()}var f,p,g,d,m,L=this,w=[],P=(t.size||200)>>1,C=!0,T={},k=[];t=t||{},t.markers=t.markers||[],L._b=function(n){n(y(T)),k.push(n)},L.markers=function(){return r(w)},L.groups=function(){return y(T)},L.enable=function(){C||(C=!0,g="",a())},L.disable=function(){C&&(C=!1,g="",a())},L.add=function(n){w.push(n),g="",a()},L.remove=function(n){w=w.filter(function(t){return t!==n}),g="",a()},L.filter=function(n){m!==n&&(m=n,g="",a())},t.markers.map(function(n){n.position=x(n.position),w.push(l("Marker",n))}),p=setInterval(function(){d=M(n),d&&(clearInterval(p),s())},10)}function T(n,t){var e=this;v(t[0]).forEach(function(n){e[n]=function(){var o=[],i=r(arguments);return t.forEach(function(t){o.push(t[n].apply(t,i))}),"get"===n?o.length>1?o:o[0]:e}}),e.$=n}function k(t,e){function c(){return{$:t,get:M.get}}function s(t,e,o,i){var u=arguments.length>3;u||(i=o),n.each(t,function(n,t){h(e,function(e){var a=e instanceof B,s=a||e instanceof E.OverlayView,f=s?e.$.get(0):e;E.event["add"+(s?"Dom":"")+"Listener"+(i?"Once":"")](f,n,function(n){h(t,function(t){if(A(t))if(a)t.call(c(),void 0,e,e.cluster,n);else if(u){var i=r(o);i.unshift(e),i.push(n),t.apply(c(),i)}else t.call(c(),e,n)})})})})}function f(n){return function(t){if(R(t)){var e=[],o=t.map(function(t){return n.call(M,t).then(function(n){e.push(n)})});return u(o).then(function(){return y.push(e),e})}return n.apply(M,arguments).then(function(n){return y.push(n),n})}}function g(n){return function(){var t=r(arguments);return P=P.then(function(e){return A(t[0])?O(t[0].call(c(),e)).then(function(e){return t[0]=e,n.apply(M,t)}):O(n.apply(M,t))})}}var v,y=[],P=O(),M=this;M.map=g(function(n){return v||L(n,"center",function(n){return v=l("Map",t.get(0),n),y.push(v),v})}),d("Marker:position Circle:center InfoWindow:position:0 Polyline:path Polygon:paths",function(n){n=n.split(":");var t=n[1]||"";M[n[0].toLowerCase()]=g(f(function(e){return(t.match(/^path/)?w:L)(e,t,function(t){return"0"!==n[2]&&(t.map=v),l(n[0],t)})}))}),d("TrafficLayer TransitLayer BicyclingLayer",function(n){M[n.toLowerCase()]=g(function(){var t=l(n);return y.push(t),t.setMap(v),t})}),M.kmllayer=g(f(function(n){return n=o(n),n.map=v,O(l("KmlLayer",n))})),M.rectangle=g(f(function(n){return m(n,function(n){return n.map=v,l("Rectangle",n)})})),M.overlay=g(f(function(n){function t(n){return b(v,n)}return n=o(n),n.bounds?m(n,t):L(n,"position",t)})),M.groundoverlay=g(function(n,t,e){return m({bounds:t},function(t){e=o(e),e.map=v;var r=l("GroundOverlay",n,t.bounds,e);return y.push(r),r})}),M.styledmaptype=g(function(n,t,e){var o=l("StyledMapType",t,e);return y.push(o),v.mapTypes.set(n,o),o}),M.streetviewpanorama=g(function(t,e){return L(e,"position",function(e){var o=l("StreetViewPanorama",n(t).get(0),e);return v.setStreetView(o),y.push(o),o})}),M.route=g(function(n){var t=$();return n=o(n),n.origin=x(n.origin),n.destination=x(n.destination),p("DirectionsService").route(n,function(n,e){y.push(n),t.resolve(e===E.DirectionsStatus.OK&&n)}),t}),M.cluster=g(function(n){var t=new C(v,o(n));return y.push(t),a(t)}),M.directionsrenderer=g(function(t){var e;return t&&(t=o(t),t.map=v,t.panel&&(t.panel=n(t.panel).get(0)),e=l("DirectionsRenderer",t)),y.push(e),e}),M.latlng=g(f(function(n){return L(n,"latlng",function(n){return y.push(n.latlng),n.latlng})})),M.fit=g(function(){var n=l("LatLngBounds");return h(y,function(t){t!==v&&h(t,function(t){t&&(t.getPosition&&t.getPosition()?n.extend(t.getPosition()):t.getBounds&&t.getBounds()?(n.extend(t.getBounds().getNorthEast()),n.extend(t.getBounds().getSouthWest())):t.getPaths&&t.getPaths()?h(t.getPaths().getArray(),function(t){h(t.getArray(),function(t){n.extend(t)})}):t.getPath&&t.getPath()?h(t.getPath().getArray(),function(t){n.extend(t)}):t.getCenter&&t.getCenter()&&n.extend(t.getCenter()))})}),n.isEmpty()||v.fitBounds(n),!0}),M.wait=function(n){P=P.then(function(t){var e=$();return setTimeout(function(){e.resolve(t)},n),e})},M.then=function(n){A(n)&&(P=P.then(function(t){return O(n.call(c(),t)).then(function(n){return i(n)?t:n})}))},M["catch"]=function(n){A(n)&&(P=P.then(null,function(t){return O(n.call(c(),t))}))},d("on once",function(n,t){M[n]=function(){var n=arguments[0];n&&("string"==typeof n&&(n={},n[arguments[0]]=r(arguments,1)),P.then(function(e){if(e){if(e instanceof C)return e._b(function(e){e&&e.length&&s(n,e,t)}),s(n,e.markers(),[void 0,e],t);s(n,e,t)}}))}}),M.get=function(n){return i(n)?y.map(function(n){return R(n)?n.slice():n}):(n<0&&(n=y.length+n),R(y[n])?y[n].slice():y[n])},e&&M.map(e)}var E,j,D={},O=n.when,S=n.extend,R=n.isArray,A=n.isFunction,$=n.Deferred;O(function(){var o,r=$(),i="__gmap3";return n.holdReady(!0),s(function(){t.google&&t.google.maps||j===!1?r.resolve():(t[i]=function(){delete t[i],r.resolve()},o=e.createElement("script"),o.type="text/javascript",o.src="https://maps.googleapis.com/maps/api/js?callback="+i+(j?"&"+("string"==typeof j?j:f(j)):""),n("head").append(o))}),r}()).then(function(){n.holdReady(!1)}),n.gmap3=function(n){j=n},n.fn.gmap3=function(e){var o=[];return E=t.google.maps,this.each(function(){var t=n(this),r=t.data("gmap3");r||(r=new k(t,e),t.data("gmap3",r)),o.push(r)}),new T(this,o)}}(jQuery,window,document);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdtYXAzLmpzIl0sIm5hbWVzIjpbIiQiLCJ3aW5kb3ciLCJkb2N1bWVudCIsImR1cE9wdHMiLCJvcHRpb25zIiwiZXh0ZW5kIiwic2xpY2UiLCJmbiIsIkFycmF5IiwicHJvdG90eXBlIiwiYXJncyIsImNhbGwiLCJhcmd1bWVudHMiLCJhcHBseSIsImlzVW5kZWZpbmVkIiwidmFsdWUiLCJhbGwiLCJkZWZlcnJlZHMiLCJ3aGVuIiwicmVzb2x2ZWQiLCJ0aGVuIiwiZGlzdGFuY2VJbk1ldGVyIiwib3JpZ2luIiwiZGVzdGluYXRpb24iLCJtIiwiTWF0aCIsInBpIiwiUEkiLCJlIiwibGF0IiwiZiIsImxuZyIsImciLCJoIiwiY29zIiwic2luIiwiYWNvcyIsIm1pbiIsInJlYWR5IiwicmVhZHlTdGF0ZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJzZXJpYWxpemUiLCJvYmoiLCJvYmplY3RLZXlzIiwibWFwIiwia2V5IiwiZW5jb2RlVVJJQ29tcG9uZW50Iiwiam9pbiIsInNlcnZpY2UiLCJuYW1lIiwic2VydmljZXMiLCJnbUVsZW1lbnQiLCJGIiwiY2xzIiwidGhpcyIsImdtIiwiZ2VvY29kZSIsInJlcXVlc3QiLCJkZmQiLCJkZWZlcnJlZCIsImFkZHJlc3MiLCJyZXN1bHRzIiwic3RhdHVzIiwiR2VvY29kZXJTdGF0dXMiLCJPSyIsInJlc29sdmUiLCJnZW9tZXRyeSIsImxvY2F0aW9uIiwicmVqZWN0IiwiZm9yZWFjaFN0ciIsInN0ciIsImZvcmVhY2giLCJzcGxpdCIsIml0ZW1zIiwiaXNBcnJheSIsImZvckVhY2giLCJPYmplY3QiLCJrZXlzIiwib2JqZWN0VmFsdWVzIiwicmVzb2x2ZUxhdExuZ0JvdW5kcyIsImJvdW5kcyIsInRvTGF0TG5nQm91bmQiLCJyZXNvbHZlTGF0TG5nIiwibGF0TG5nIiwidG9MYXRMbmciLCJmYWlsIiwicmVhc29uIiwicmVzb2x2ZUFycmF5T2ZMYXRMbmciLCJtaXhlZCIsImNvbnZlcnRMaXRlcmFsIiwiTGF0TG5nIiwiTGF0TG5nQm91bmRzIiwiZ2V0Q2VudGVyIiwic291dGgiLCJ3ZXN0Iiwibm9ydGgiLCJlYXN0IiwiY3JlYXRlT3ZlcmxheVZpZXciLCJPdmVybGF5VmlldyIsImZyb21MYXRMbmdUb0RpdlBpeGVsIiwibGF0bG5nIiwic2VsZiIsImdldFByb2plY3Rpb24iLCJsaXN0ZW5lcnMiLCJHTU92ZXJsYXlWaWV3Iiwic2V0TWFwIiwib25BZGQiLCJwYW5lcyIsImdldFBhbmVzIiwib3ZlcmxheU1vdXNlVGFyZ2V0IiwiYXBwZW5kQ2hpbGQiLCIkZGl2IiwicG9zaXRpb24iLCJnZXRQb3NpdGlvbiIsInNldFBvc2l0aW9uIiwiZHJhdyIsInBzIiwiY3NzIiwibGVmdCIsIngiLCJ0b3AiLCJ5IiwiZ2V0Qm91bmRzIiwic2V0Qm91bmRzIiwic3ciLCJnZXRTb3V0aFdlc3QiLCJuZSIsImdldE5vcnRoRWFzdCIsIndpZHRoIiwiaGVpZ2h0Iiwib25SZW1vdmUiLCJoYW5kbGVyIiwiZXZlbnQiLCJyZW1vdmVMaXN0ZW5lciIsInJlbW92ZSIsImNyZWF0ZUVsZW1lbnQiLCJib3JkZXIiLCJib3JkZXJXaWR0aCIsImFwcGVuZCIsImNvbnRlbnQiLCJPdmVybGF5Iiwib3ZlcmxheSIsIkNsdXN0ZXJPdmVybGF5IiwiY2x1c3RlciIsIm1hcmtlcnMiLCJDbHVzdGVyIiwiZXh0ZW5kc01hcEJvdW5kcyIsImNpcmNsZSIsImNlbnRlciIsInJhZGl1cyIsImV4dGVuZHNCb3VuZHMiLCJwIiwicHJvamVjdGlvbiIsImZyb21EaXZQaXhlbFRvTGF0TG5nIiwicmVkcmF3Iiwib3ZlcmxheU9wdGlvbnMiLCJoYXNoIiwiY3VycmVudE1hcmtlcnMiLCJ2aWV3SGFzaCIsInpvb20iLCJnZXRab29tIiwiY3VycmVudEhhc2hlcyIsIm5ld092ZXJsYXlzIiwiaWdub3JlIiwibWFya2VyIiwiaW5kZXgiLCJjb250YWlucyIsImdldE1hcCIsImZpbHRlciIsInByZXZpb3VzVmlld0hhc2giLCJlbmFibGVkIiwiaWR4IiwicHVzaCIsIm92ZXJsYXlzIiwiY2IiLCJsZW5ndGgiLCJoYW5kbGVycyIsImRlbGF5UmVkcmF3IiwiY2xlYXJUaW1lb3V0IiwidGltZXIiLCJzZXRUaW1lb3V0IiwiaW5pdCIsImFkZExpc3RlbmVyIiwiaWduaXRlciIsInNpemUiLCJfYiIsImdyb3VwcyIsImVuYWJsZSIsImRpc2FibGUiLCJhZGQiLCJpdGVtIiwib3B0cyIsInNldEludGVydmFsIiwiY2xlYXJJbnRlcnZhbCIsIkhhbmRsZXIiLCJjaGFpbiIsIkdtYXAzIiwiJGNvbnRhaW5lciIsImNvbnRleHQiLCJnZXQiLCJhdHRhY2hFdmVudHMiLCJldmVudHMiLCJpbnN0YW5jZXMiLCJvbmNlIiwiaGFzQXJncyIsImVhY2giLCJldmVudE5hbWUiLCJpbnN0YW5jZSIsImlzQ2x1c3Rlck92ZXJsYXkiLCJpc0RvbSIsImV2ZW50TGlzdGVuZXIiLCJpc0Z1bmN0aW9uIiwidW5kZWZpbmVkIiwiYnVmZmVyIiwidW5zaGlmdCIsIm11bHRpcGxlIiwicHJvbWlzZXMiLCJwcmV2aW91c1Jlc3VsdHMiLCJjaGFpblRvUHJvbWlzZSIsInByb21pc2UiLCJwcm9wZXJ0eSIsInRvTG93ZXJDYXNlIiwibWF0Y2giLCJrbWxsYXllciIsInJlY3RhbmdsZSIsImdyb3VuZG92ZXJsYXkiLCJ1cmwiLCJzdHlsZWRtYXB0eXBlIiwic3R5bGVJZCIsInN0eWxlcyIsIm1hcFR5cGVzIiwic2V0Iiwic3RyZWV0dmlld3Bhbm9yYW1hIiwiY29udGFpbmVyIiwic2V0U3RyZWV0VmlldyIsInJvdXRlIiwiRGlyZWN0aW9uc1N0YXR1cyIsImRpcmVjdGlvbnNyZW5kZXJlciIsInBhbmVsIiwiZml0IiwiZ2V0UGF0aHMiLCJnZXRBcnJheSIsInBhdGgiLCJnZXRQYXRoIiwiaXNFbXB0eSIsImZpdEJvdW5kcyIsIndhaXQiLCJkdXJhdGlvbiIsIm5ld0luc3RhbmNlIiwibG9hZE9wdGlvbnMiLCJEZWZlcnJlZCIsInNjcmlwdCIsImNiTmFtZSIsImhvbGRSZWFkeSIsImdvb2dsZSIsIm1hcHMi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RUFBTUMsSUFDUmlNLEVBQVMsU0FxQlgsT0FsQkE1UCxHQUFFNlAsV0FBVSxHQUVadk4sRUFBTSxXQUNBckMsRUFBTzZQLFFBQVU3UCxFQUFPNlAsT0FBT0MsTUFBUU4sS0FBZ0IsRUFDekQvTCxFQUFJTyxXQUdKaEUsRUFBTzJQLEdBQVUsaUJBQ1IzUCxHQUFPMlAsR0FDZGxNLEVBQUlPLFdBRU4wTCxFQUFTelAsRUFBU3FJLGNBQWMsVUFDaENvSCxFQUFPSyxLQUFPLGtCQUNkTCxFQUFPTSxJQUFNLG9EQUFzREwsR0FBVUgsRUFBYyxLQUE4QixnQkFBaEJBLEdBQTJCQSxFQUFjaE4sRUFBVWdOLElBQWdCLElBQzVLelAsRUFBRSxRQUFRMEksT0FBT2lILE1BSWRqTSxNQUNKdEMsS0FBSyxXQUNScEIsRUFBRTZQLFdBQVUsS0F1bkJkN1AsRUFBRWtRLE1BQVEsU0FBVTlQLEdBQ2xCcVAsRUFBY3JQLEdBTWhCSixFQUFFTyxHQUFHMlAsTUFBUSxTQUFVOVAsR0FDckIsR0FBSXFFLEtBV0osT0FWQWxCLEdBQUt0RCxFQUFPNlAsT0FBT0MsS0FDbkJ6TSxLQUFLdUosS0FBSyxXQUNSLEdBQUlzRCxHQUFRblEsRUFBRXNELE1BQU80TSxFQUFRQyxFQUFNQyxLQUFLLFFBQ25DRixLQUNIQSxFQUFRLEdBQUk5RCxHQUFNK0QsRUFBTy9QLEdBQ3pCK1AsRUFBTUMsS0FBSyxRQUFTRixJQUV0QnpMLEVBQU1tRyxLQUFLc0YsS0FHTixHQUFJaEUsR0FBUTVJLEtBQU1tQixLQXdXMUI0TCxPQUFRcFEsT0FBUUMiLCJmaWxlIjoiZ21hcDMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAqICBHTUFQMyBQbHVnaW4gZm9yIGpRdWVyeVxuICogIFZlcnNpb24gIDogNy4yXG4gKiAgRGF0ZSAgICAgOiAyMDE2LzEyLzAzXG4gKiAgQXV0aG9yICAgOiBERU1PTlRFIEplYW4tQmFwdGlzdGVcbiAqICBDb250YWN0ICA6IGpiZGVtb250ZUBnbWFpbC5jb21cbiAqICBXZWIgc2l0ZSA6IGh0dHA6Ly9nbWFwMy5uZXRcbiAqICBMaWNlbmNlICA6IEdQTC0zLjArXG4gKi9cbihmdW5jdGlvbiAoJCwgd2luZG93LCBkb2N1bWVudCkge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICB2YXIgZ20sIHNlcnZpY2VzID0ge30sIGxvYWRPcHRpb25zLFxuXG4gIC8vIFByb3hpZnkgZnVuY3Rpb25zIHRvIGdldCBzaG9ydGVyIG1pbmltaXplZCBjb2RlXG4gICAgd2hlbiA9ICQud2hlbixcbiAgICBleHRlbmQgPSAkLmV4dGVuZCxcbiAgICBpc0FycmF5ID0gJC5pc0FycmF5LFxuICAgIGlzRnVuY3Rpb24gPSAkLmlzRnVuY3Rpb24sXG4gICAgZGVmZXJyZWQgPSAkLkRlZmVycmVkO1xuXG4gIC8qKlxuICAgKiBEdXBsaWNhdGUgb3B0aW9uIHRvIG5ldmVyIG1vZGlmeSBvcmlnaW5hbCBvYmplY3RcbiAgICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnNcbiAgICogQHJldHVybnMge09iamVjdH1cbiAgICovXG4gIGZ1bmN0aW9uIGR1cE9wdHMob3B0aW9ucykge1xuICAgIHJldHVybiBleHRlbmQodHJ1ZSwge30sIG9wdGlvbnMgfHwge30pO1xuICB9XG5cbiAgLyoqXG4gICAqIFNsaWNlIGFuIGFycmF5IGxpa2VcbiAgICogQHBhcmFtcyB7QXJyYXl8T2JqZWN0fVxuICAgKiBAcGFyYW1zIHtOdW1iZXJ9IFtzdGFydF1cbiAgICogQHBhcmFtcyB7TnVtYmVyfSBbZW5kXVxuICAgKiBAcmV0dXJucyB7QXJyYXl9XG4gICAqL1xuICBmdW5jdGlvbiBzbGljZSgpIHtcbiAgICB2YXIgZm4gPSBBcnJheS5wcm90b3R5cGUuc2xpY2UsXG4gICAgICBhcmdzID0gZm4uY2FsbChhcmd1bWVudHMsIDEpO1xuICAgIHJldHVybiBmbi5hcHBseShhcmd1bWVudHNbMF0sIGFyZ3MpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybiB0cnVlIGlmIHZhbHVlIGlzIHVuZGVmaW5lZFxuICAgKiBAcGFyYW0geyp9IHZhbHVlXG4gICAqIEByZXR1cm5zIHtCb29sZWFufVxuICAgKi9cbiAgZnVuY3Rpb24gaXNVbmRlZmluZWQodmFsdWUpIHtcbiAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAndW5kZWZpbmVkJztcbiAgfVxuXG4gIC8qKlxuICAgKiBFcXVpdmFsZW50IHRvIFByb21pc2UuYWxsXG4gICAqIEBwYXJhbSB7RGVmZXJyZWRbXX0gZGVmZXJyZWRzXG4gICAqIEByZXR1cm5zIHtEZWZlcnJlZH1cbiAgICovXG4gIGZ1bmN0aW9uIGFsbChkZWZlcnJlZHMpIHtcbiAgICByZXR1cm4gd2hlbi5hcHBseSgkLCBkZWZlcnJlZHMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEVxdWl2YWxlbnQgdG8gUHJvbWlzZS5yZXNvbHZlXG4gICAqIEBwYXJhbSB7Kn0gdmFsdWVcbiAgICogQHJldHVybnMge0RlZmVycmVkfVxuICAgKi9cbiAgZnVuY3Rpb24gcmVzb2x2ZWQodmFsdWUpIHtcbiAgICByZXR1cm4gd2hlbigpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIHJldHVybiB0aGUgZGlzdGFuY2UgYmV0d2VlbiAyIGxhdExuZyBpbiBtZXRlcnNcbiAgICogQHBhcmFtIHtMYXRMbmd9IG9yaWdpblxuICAgKiBAcGFyYW0ge0xhdExuZ30gZGVzdGluYXRpb25cbiAgICogQHJldHVybnMge051bWJlcn1cbiAgICoqL1xuICBmdW5jdGlvbiBkaXN0YW5jZUluTWV0ZXIob3JpZ2luLCBkZXN0aW5hdGlvbikge1xuICAgIHZhciBtID0gTWF0aCxcbiAgICAgIHBpID0gbS5QSSxcbiAgICAgIGUgPSBwaSAqIG9yaWdpbi5sYXQoKSAvIDE4MCxcbiAgICAgIGYgPSBwaSAqIG9yaWdpbi5sbmcoKSAvIDE4MCxcbiAgICAgIGcgPSBwaSAqIGRlc3RpbmF0aW9uLmxhdCgpIC8gMTgwLFxuICAgICAgaCA9IHBpICogZGVzdGluYXRpb24ubG5nKCkgLyAxODAsXG4gICAgICBjb3MgPSBtLmNvcyxcbiAgICAgIHNpbiA9IG0uc2luO1xuICAgIHJldHVybiAxMDAwICogNjM3MSAqIG0uYWNvcyhtLm1pbihjb3MoZSkgKiBjb3MoZykgKiBjb3MoZikgKiBjb3MoaCkgKyBjb3MoZSkgKiBzaW4oZikgKiBjb3MoZykgKiBzaW4oaCkgKyBzaW4oZSkgKiBzaW4oZyksIDEpKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJlYWR5KGZuKSB7XG4gICAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgIT0gJ2xvYWRpbmcnKSB7XG4gICAgICBmbigpO1xuICAgIH0gZWxzZSB7XG4gICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZm4pO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHNlcmlhbGl6ZShvYmopIHtcbiAgICByZXR1cm4gb2JqZWN0S2V5cyhvYmopLm1hcChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KGtleSkgKyBcIj1cIiArIGVuY29kZVVSSUNvbXBvbmVudChvYmpba2V5XSk7XG4gICAgfSkuam9pbihcIiZcIik7XG4gIH1cblxuICAvLyBBdXRvLWxvYWQgZ29vZ2xlIG1hcHMgbGlicmFyeSBpZiBuZWVkZWRcbiAgd2hlbihmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGRmZCA9IGRlZmVycmVkKCksXG4gICAgICBjYk5hbWUgPSAnX19nbWFwMycsXG4gICAgICBzY3JpcHQ7XG5cbiAgICAkLmhvbGRSZWFkeSh0cnVlKTtcblxuICAgIHJlYWR5KGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICh3aW5kb3cuZ29vZ2xlICYmIHdpbmRvdy5nb29nbGUubWFwcyB8fCBsb2FkT3B0aW9ucyA9PT0gZmFsc2UpIHtcbiAgICAgICAgZGZkLnJlc29sdmUoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIGNhbGxiYWNrIGZ1bmN0aW9uIC0gcmVzb2x2aW5nIHByb21pc2UgYWZ0ZXIgbWFwcyBzdWNjZXNzZnVsbHkgbG9hZGVkXG4gICAgICAgIHdpbmRvd1tjYk5hbWVdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGRlbGV0ZSB3aW5kb3dbY2JOYW1lXTtcbiAgICAgICAgICBkZmQucmVzb2x2ZSgpO1xuICAgICAgICB9O1xuICAgICAgICBzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcbiAgICAgICAgc2NyaXB0LnR5cGUgPSAndGV4dC9qYXZhc2NyaXB0JztcbiAgICAgICAgc2NyaXB0LnNyYyA9ICdodHRwczovL21hcHMuZ29vZ2xlYXBpcy5jb20vbWFwcy9hcGkvanM/Y2FsbGJhY2s9JyArIGNiTmFtZSArIChsb2FkT3B0aW9ucyA/ICcmJyArICh0eXBlb2YgbG9hZE9wdGlvbnMgPT09ICdzdHJpbmcnID8gbG9hZE9wdGlvbnMgOiBzZXJpYWxpemUobG9hZE9wdGlvbnMpKSA6ICcnKTtcbiAgICAgICAgJChcImhlYWRcIikuYXBwZW5kKHNjcmlwdCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gZGZkO1xuICB9KCkpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICQuaG9sZFJlYWR5KGZhbHNlKTtcbiAgfSk7XG5cbiAgLyoqXG4gICAqIEluc3RhbnRpYXRlIG9ubHkgb25jZSBhIGdvb2dsZSBzZXJ2aWNlXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lXG4gICAqIEByZXR1cm5zIHtPYmplY3R9XG4gICAqL1xuICBmdW5jdGlvbiBzZXJ2aWNlKG5hbWUpIHtcbiAgICBpZiAoIXNlcnZpY2VzW25hbWVdKSB7XG4gICAgICBzZXJ2aWNlc1tuYW1lXSA9IGdtRWxlbWVudChuYW1lKTtcbiAgICB9XG4gICAgcmV0dXJuIHNlcnZpY2VzW25hbWVdO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybiBHb29nbGVNYXAgQ2xhc3MgKG9yIG92ZXJ3cml0dGVuIGJ5IHVzZXIpIGluc3RhbmNlXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lXG4gICAqIEByZXR1cm5zIHtPYmplY3R9XG4gICAqL1xuICBmdW5jdGlvbiBnbUVsZW1lbnQobmFtZSkge1xuICAgIHZhciBjbHMgPSBnbVtuYW1lXTtcblxuICAgIGZ1bmN0aW9uIEYoYXJncykge1xuICAgICAgcmV0dXJuIGNscy5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICB9XG4gICAgRi5wcm90b3R5cGUgPSBjbHMucHJvdG90eXBlO1xuXG4gICAgcmV0dXJuIG5ldyBGKHNsaWNlKGFyZ3VtZW50cywgMSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlc29sdmUgYSBHZW9jb2RlUmVxdWVzdFxuICAgKiBodHRwczovL2RldmVsb3BlcnMuZ29vZ2xlLmNvbS9tYXBzL2RvY3VtZW50YXRpb24vamF2YXNjcmlwdC9nZW9jb2RpbmdcbiAgICogQHBhcmFtIHtTdHJpbmd8T2JqZWN0fSByZXF1ZXN0XG4gICAqIEByZXR1cm5zIHtEZWZlcnJlZH1cbiAgICovXG4gIGZ1bmN0aW9uIGdlb2NvZGUocmVxdWVzdCkge1xuICAgIHZhciBkZmQgPSBkZWZlcnJlZCgpO1xuICAgIGlmICh0eXBlb2YgcmVxdWVzdCA9PT0gJ3N0cmluZycpIHtcbiAgICAgIHJlcXVlc3QgPSB7XG4gICAgICAgIGFkZHJlc3M6IHJlcXVlc3RcbiAgICAgIH07XG4gICAgfVxuICAgIHNlcnZpY2UoJ0dlb2NvZGVyJykuZ2VvY29kZShyZXF1ZXN0LCBmdW5jdGlvbiAocmVzdWx0cywgc3RhdHVzKSB7XG4gICAgICBpZiAoc3RhdHVzID09PSBnbS5HZW9jb2RlclN0YXR1cy5PSykge1xuICAgICAgICBkZmQucmVzb2x2ZShyZXN1bHRzWzBdLmdlb21ldHJ5LmxvY2F0aW9uKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGRmZC5yZWplY3Qoc3RhdHVzKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gZGZkO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGxhYmxlIGZ1bmN0aW9uIHRha2luZyBhIHBhcmFtZXRlciBhcyBzdHJpbmdcbiAgICogQGNhbGxiYWNrIFN0cmluZ0NhbGxiYWNrXG4gICAqIEBwYXJhbSB7U3RyaW5nfVxuICAgKi9cblxuICAvKipcbiAgICogU3BsaXQgYSBzdHJpbmcgYW5kIGV4ZWN1dGUgYSBmdW5jdGlvbiBvbiBlYWNoIGl0ZW1cbiAgICogQHBhcmFtIHtTdHJpbmd9IHN0ciAtIFNwYWNlIHNlcGFyYXRlZCBsaXN0IG9mIGl0ZW1zXG4gICAqIEBwYXJhbSB7U3RyaW5nQ2FsbGJhY2t9IGZuIC0gQ2FsbGJhY2sgZnVuY3Rpb25cbiAgICovXG4gIGZ1bmN0aW9uIGZvcmVhY2hTdHIoc3RyLCBmbikge1xuICAgIGZvcmVhY2goc3RyLnNwbGl0KCcgJyksIGZuKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBFeGVjdXRlIGEgZnVuY3Rpb24gb24gZWFjaCBpdGVtcyBpZiBpdGVtcyBpcyBhbiBhcnJheSBhbmQgb24gaXRlbXMgYXMgYSBzaW5nbGUgZWxlbWVudCBpZiBpdCBpcyBub3QgYW4gYXJyYXlcbiAgICogQHBhcmFtIHtBcnJheXwqfSBpdGVtcyAtIEl0ZW1zIHRvIGV4ZWN1dGUgZm9yZWFjaCBjYWxsYmFjayBvblxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiAtIENhbGxiYWNrIGZ1bmN0aW9uXG4gICAqL1xuICBmdW5jdGlvbiBmb3JlYWNoKGl0ZW1zLCBmbikge1xuICAgIChpc0FycmF5KGl0ZW1zKSA/IGl0ZW1zIDogW2l0ZW1zXSkuZm9yRWFjaChmbik7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJuIE9iamVjdCBrZXlzXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBvYmpcbiAgICogQHJldHVybnMge1N0cmluZ1tdfVxuICAgKi9cbiAgZnVuY3Rpb24gb2JqZWN0S2V5cyhvYmopIHtcbiAgICByZXR1cm4gT2JqZWN0LmtleXMob2JqKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm4gT2JqZWN0IHZhbHVlc1xuICAgKiBAcGFyYW0ge09iamVjdH0gb2JqXG4gICAqIEByZXR1cm5zIHsqW119XG4gICAqL1xuICBmdW5jdGlvbiBvYmplY3RWYWx1ZXMob2JqKSB7XG4gICAgcmV0dXJuIG9iamVjdEtleXMob2JqKS5tYXAoZnVuY3Rpb24gKGtleSkge1xuICAgICAgcmV0dXJuIG9ialtrZXldO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlc29sdXRpb24gZnVuY3Rpb25cbiAgICogQGNhbGxiYWNrIE9wdGlvbkNhbGxiYWNrXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zXG4gICAqIEByZXR1cm5zIHtEZWZlcnJlZHwqfVxuICAgKi9cblxuICAvKipcbiAgICogQ29udmVydCBib3VuZHMgZnJvbSBhcnJheSBbIG4sIGUsIHMsIHcgXSB0byBnb29nbGUubWFwcy5MYXRMbmdCb3VuZHNcbiAgICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMgLSBDb250YWluZXIgb2Ygb3B0aW9ucy5ib3VuZHNcbiAgICogQHBhcmFtIHtPcHRpb25DYWxsYmFja30gZm5cbiAgICogQHJldHVybnMge0RlZmVycmVkfVxuICAgKi9cbiAgZnVuY3Rpb24gcmVzb2x2ZUxhdExuZ0JvdW5kcyhvcHRpb25zLCBmbikge1xuICAgIG9wdGlvbnMgPSBkdXBPcHRzKG9wdGlvbnMpO1xuICAgIGlmIChvcHRpb25zLmJvdW5kcykge1xuICAgICAgb3B0aW9ucy5ib3VuZHMgPSB0b0xhdExuZ0JvdW5kKG9wdGlvbnMuYm91bmRzKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc29sdmVkKGZuKG9wdGlvbnMpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXNvbHZlIGFuIGFkZHJlc3MgbG9jYXRpb24gLyBjb252ZXJ0IGEgTGF0TG5nIGFycmF5IHRvIGdvb2dsZS5tYXBzLkxhdExuZyBvYmplY3RcbiAgICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnNcbiAgICogQHBhcmFtIHtTdHJpbmd9IGtleSAtIExhdExuZyBrZXkgbmFtZSBpbiBvcHRpb25zIG9iamVjdFxuICAgKiBAcGFyYW0ge09wdGlvbkNhbGxiYWNrfSBmblxuICAgKiBAcmV0dXJucyB7RGVmZXJyZWR9XG4gICAqL1xuICBmdW5jdGlvbiByZXNvbHZlTGF0TG5nKG9wdGlvbnMsIGtleSwgZm4pIHtcbiAgICB2YXIgZGZkID0gZGVmZXJyZWQoKTtcbiAgICBvcHRpb25zID0gZHVwT3B0cyhvcHRpb25zKTtcbiAgICB3aGVuKClcbiAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFkZHJlc3MgPSBvcHRpb25zLmFkZHJlc3M7XG4gICAgICAgIGlmIChhZGRyZXNzKSB7XG4gICAgICAgICAgZGVsZXRlIG9wdGlvbnMuYWRkcmVzcztcbiAgICAgICAgICByZXR1cm4gZ2VvY29kZShhZGRyZXNzKS50aGVuKGZ1bmN0aW9uIChsYXRMbmcpIHtcbiAgICAgICAgICAgICAgb3B0aW9uc1trZXldID0gbGF0TG5nO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgb3B0aW9uc1trZXldID0gdG9MYXRMbmcob3B0aW9uc1trZXldKTtcbiAgICAgIH0pXG4gICAgICAudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgIGRmZC5yZXNvbHZlKGZuKG9wdGlvbnMpKTtcbiAgICAgIH0pXG4gICAgICAuZmFpbChmdW5jdGlvbiAocmVhc29uKSB7XG4gICAgICAgIGRmZC5yZWplY3QocmVhc29uKTtcbiAgICAgIH0pO1xuICAgIHJldHVybiBkZmQ7XG4gIH1cblxuICAvKipcbiAgICogQ29udmVydCBhbiBhcnJheSBvZiBtaXhlZCBMYXRMbmcgdG8gZ29vZ2xlLm1hcHMuTGF0TG5nIG9iamVjdFxuICAgKiBObyBhZGRyZXNzIHJlc29sdXRpb24gaGVyZVxuICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9uc1xuICAgKiBAcGFyYW0ge1N0cmluZ30ga2V5IC0gQXJyYXkga2V5IG5hbWUgaW4gb3B0aW9ucyBvYmplY3RcbiAgICogQHBhcmFtIHtPcHRpb25DYWxsYmFja30gZm5cbiAgICogQHJldHVybnMge0RlZmVycmVkfVxuICAgKi9cbiAgZnVuY3Rpb24gcmVzb2x2ZUFycmF5T2ZMYXRMbmcob3B0aW9ucywga2V5LCBmbikge1xuICAgIG9wdGlvbnMgPSBkdXBPcHRzKG9wdGlvbnMpO1xuICAgIG9wdGlvbnNba2V5XSA9IChvcHRpb25zW2tleV0gfHwgW10pLm1hcCh0b0xhdExuZyk7XG4gICAgcmV0dXJuIHJlc29sdmVkKGZuKG9wdGlvbnMpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDb252ZXJ0IGEgTGF0TG5nIGFycmF5IHRvIGdvb2dsZS5tYXBzLkxhdExuZ1xuICAgKiBAcGFyYW0ge0FycmF5fCp9IG1peGVkXG4gICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbnZlcnRMaXRlcmFsXVxuICAgKiBAcmV0dXJucyB7TGF0TG5nfVxuICAgKi9cbiAgZnVuY3Rpb24gdG9MYXRMbmcobWl4ZWQsIGNvbnZlcnRMaXRlcmFsKSB7XG4gICAgcmV0dXJuIGlzQXJyYXkobWl4ZWQpID8gbmV3IGdtLkxhdExuZyhtaXhlZFswXSwgbWl4ZWRbMV0pIDogKGNvbnZlcnRMaXRlcmFsICYmIG1peGVkICYmICEobWl4ZWQgaW5zdGFuY2VvZiBnbS5MYXRMbmcpID8gbmV3IGdtLkxhdExuZyhtaXhlZC5sYXQsIG1peGVkLmxuZykgOiBtaXhlZCk7XG4gIH1cblxuICAvKipcbiAgICogQ29udmVydCBhIExhdExuZ0JvdW5kIGFycmF5IHRvIGdvb2dsZS5tYXBzLkxhdExuZ0JvdW5kXG4gICAqIEBwYXJhbSB7QXJyYXl8Kn0gbWl4ZWRcbiAgICogQHBhcmFtIHtCb29sZWFufSBbY29udmVydExpdGVyYWxdXG4gICAqIEByZXR1cm5zIHtMYXRMbmdCb3VuZHN9XG4gICAqL1xuICBmdW5jdGlvbiB0b0xhdExuZ0JvdW5kKG1peGVkLCBjb252ZXJ0TGl0ZXJhbCkge1xuICAgIGlmIChpc0FycmF5KG1peGVkKSkge1xuICAgICAgcmV0dXJuIG5ldyBnbS5MYXRMbmdCb3VuZHMoe2xhdDogbWl4ZWRbMl0sIGxuZzogbWl4ZWRbM119LCB7bGF0OiBtaXhlZFswXSwgbG5nOiBtaXhlZFsxXX0pO1xuICAgIH0gZWxzZSBpZiAoY29udmVydExpdGVyYWwgJiYgIW1peGVkLmdldENlbnRlcil7XG4gICAgICByZXR1cm4gbmV3IGdtLkxhdExuZ0JvdW5kcyh7bGF0OiBtaXhlZC5zb3V0aCwgbG5nOiBtaXhlZC53ZXN0fSwge2xhdDogbWl4ZWQubm9ydGgsIGxuZzogbWl4ZWQuZWFzdH0pO1xuICAgIH1cbiAgICByZXR1cm4gbWl4ZWQ7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlIGEgY3VzdG9tIG92ZXJsYXkgdmlld1xuICAgKiBAcGFyYW0ge01hcH0gbWFwXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zXG4gICAqIEByZXR1cm5zIHtPdmVybGF5Vmlld31cbiAgICovXG4gIGZ1bmN0aW9uIGNyZWF0ZU92ZXJsYXlWaWV3KG1hcCwgb3B0aW9ucykge1xuXG4gICAgdmFyIEdNT3ZlcmxheVZpZXcgPSBnbS5PdmVybGF5VmlldztcblxuICAgIHZhciAkZGl2ID0gJChkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpKVxuICAgICAgLmNzcyh7XG4gICAgICAgIGJvcmRlcjogXCJub25lXCIsXG4gICAgICAgIGJvcmRlcldpZHRoOiAwLFxuICAgICAgICBwb3NpdGlvbjogXCJhYnNvbHV0ZVwiXG4gICAgICB9KVxuICAgICAgLmFwcGVuZChvcHRpb25zLmNvbnRlbnQpO1xuXG4gICAgb3B0aW9ucyA9IGV4dGVuZCh7eDogMCwgeTogMH0sIG9wdGlvbnMpO1xuXG4gICAgaWYgKG9wdGlvbnMucG9zaXRpb24pIHtcbiAgICAgIG9wdGlvbnMucG9zaXRpb24gPSB0b0xhdExuZyhvcHRpb25zLnBvc2l0aW9uLCB0cnVlKTtcbiAgICB9IGVsc2UgaWYgKG9wdGlvbnMuYm91bmRzKSB7XG4gICAgICBvcHRpb25zLmJvdW5kcyA9IHRvTGF0TG5nQm91bmQob3B0aW9ucy5ib3VuZHMsIHRydWUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsYXNzIE92ZXJsYXlWaWV3XG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICovXG4gICAgZnVuY3Rpb24gT3ZlcmxheVZpZXcoKSB7XG4gICAgICB2YXIgc2VsZiA9IHRoaXMsXG4gICAgICAgIGxpc3RlbmVycyA9IFtdO1xuXG4gICAgICBHTU92ZXJsYXlWaWV3LmNhbGwoc2VsZik7XG4gICAgICBzZWxmLnNldE1hcChtYXApO1xuXG4gICAgICBmdW5jdGlvbiBmcm9tTGF0TG5nVG9EaXZQaXhlbChsYXRsbmcpIHtcbiAgICAgICAgcmV0dXJuIHNlbGYuZ2V0UHJvamVjdGlvbigpLmZyb21MYXRMbmdUb0RpdlBpeGVsKGxhdGxuZyk7XG4gICAgICB9XG5cbiAgICAgIHNlbGYub25BZGQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBwYW5lcyA9IHNlbGYuZ2V0UGFuZXMoKTtcbiAgICAgICAgcGFuZXMub3ZlcmxheU1vdXNlVGFyZ2V0LmFwcGVuZENoaWxkKCRkaXZbMF0pO1xuICAgICAgfTtcblxuICAgICAgaWYgKG9wdGlvbnMucG9zaXRpb24pIHtcbiAgICAgICAgc2VsZi5nZXRQb3NpdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gb3B0aW9ucy5wb3NpdGlvbjtcbiAgICAgICAgfTtcblxuICAgICAgICBzZWxmLnNldFBvc2l0aW9uID0gZnVuY3Rpb24gKGxhdGxuZykge1xuICAgICAgICAgIG9wdGlvbnMucG9zaXRpb24gPSBsYXRsbmc7XG4gICAgICAgICAgc2VsZi5kcmF3KCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgc2VsZi5kcmF3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHZhciBwcyA9IGZyb21MYXRMbmdUb0RpdlBpeGVsKG9wdGlvbnMucG9zaXRpb24pO1xuICAgICAgICAgICRkaXYuY3NzKHtcbiAgICAgICAgICAgIGxlZnQ6IChwcy54ICsgb3B0aW9ucy54KSArICdweCcsXG4gICAgICAgICAgICB0b3A6IChwcy55ICsgb3B0aW9ucy55KSArICdweCdcbiAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNlbGYuZ2V0Qm91bmRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiBvcHRpb25zLmJvdW5kcztcbiAgICAgICAgfTtcblxuICAgICAgICBzZWxmLnNldEJvdW5kcyA9IGZ1bmN0aW9uIChib3VuZHMpIHtcbiAgICAgICAgICBvcHRpb25zLmJvdW5kcyA9IGJvdW5kcztcbiAgICAgICAgICBzZWxmLmRyYXcoKTtcbiAgICAgICAgfTtcblxuICAgICAgICBzZWxmLmRyYXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdmFyIHN3ID0gZnJvbUxhdExuZ1RvRGl2UGl4ZWwob3B0aW9ucy5ib3VuZHMuZ2V0U291dGhXZXN0KCkpO1xuICAgICAgICAgIHZhciBuZSA9IGZyb21MYXRMbmdUb0RpdlBpeGVsKG9wdGlvbnMuYm91bmRzLmdldE5vcnRoRWFzdCgpKTtcblxuICAgICAgICAgICRkaXYuY3NzKHtcbiAgICAgICAgICAgIGxlZnQ6IChzdy54ICsgb3B0aW9ucy54KSArICdweCcsXG4gICAgICAgICAgICB0b3A6IChuZS55ICsgb3B0aW9ucy55KSArICdweCcsXG4gICAgICAgICAgICB3aWR0aDogKG5lLnggLSBzdy54ICsgb3B0aW9ucy54KSArICdweCcsXG4gICAgICAgICAgICBoZWlnaHQ6IChzdy55IC0gbmUueSArIG9wdGlvbnMueSkgKyAncHgnXG4gICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIHNlbGYub25SZW1vdmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGxpc3RlbmVycy5tYXAoZnVuY3Rpb24gKGhhbmRsZXIpIHtcbiAgICAgICAgICBnbS5ldmVudC5yZW1vdmVMaXN0ZW5lcihoYW5kbGVyKTtcbiAgICAgICAgfSk7XG4gICAgICAgICRkaXYucmVtb3ZlKCk7XG4gICAgICAgIHNlbGYuJCA9ICRkaXYgPSBudWxsOyAvLyBtZW0gbGVha3NcbiAgICAgIH07XG5cbiAgICAgIHNlbGYuJCA9ICRkaXY7XG4gICAgfVxuXG4gICAgT3ZlcmxheVZpZXcucHJvdG90eXBlID0gbmV3IEdNT3ZlcmxheVZpZXcoKTtcblxuICAgIHJldHVybiBuZXcgT3ZlcmxheVZpZXcoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm4gYSBtYXAgcHJvamVjdGlvblxuICAgKiBAcGFyYW0ge01hcH0gbWFwXG4gICAqIEByZXR1cm5zIHsqfVxuICAgKi9cbiAgZnVuY3Rpb24gZ2V0UHJvamVjdGlvbihtYXApIHtcbiAgICBmdW5jdGlvbiBPdmVybGF5KCkge1xuICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgc2VsZi5vbkFkZCA9IHNlbGYub25SZW1vdmUgPSBzZWxmLmRyYXcgPSBmdW5jdGlvbiAoKSB7fTtcbiAgICAgIHJldHVybiBnbS5PdmVybGF5Vmlldy5jYWxsKHNlbGYpO1xuICAgIH1cbiAgICBPdmVybGF5LnByb3RvdHlwZSA9IG5ldyBnbS5PdmVybGF5VmlldygpO1xuICAgIHZhciBvdmVybGF5ID0gbmV3IE92ZXJsYXkoKTtcbiAgICBvdmVybGF5LnNldE1hcChtYXApO1xuICAgIHJldHVybiBvdmVybGF5LmdldFByb2plY3Rpb24oKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDbGFzcyB1c2VkIGFzIGV2ZW50IGZpcnN0IHBhcmFtZXRlciBvbiBjbHVzdGVyaW5nIG92ZXJsYXlzXG4gICAqIEBwYXJhbSB7Q2x1c3Rlcn0gY2x1c3RlclxuICAgKiBAcGFyYW0ge01hcmtlcltdfSBtYXJrZXJzXG4gICAqIEBwYXJhbSB7T3ZlcmxheVZpZXd9IG92ZXJsYXlcbiAgICogQHBhcmFtIHtMYXRMbmdCb3VuZHN9IGJvdW5kc1xuICAgKiBAY29uc3RydWN0b3JcbiAgICovXG4gIGZ1bmN0aW9uIENsdXN0ZXJPdmVybGF5KGNsdXN0ZXIsIG1hcmtlcnMsIG92ZXJsYXksIGJvdW5kcykge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBzZWxmLmNsdXN0ZXIgPSBjbHVzdGVyO1xuICAgIHNlbGYubWFya2VycyA9IG1hcmtlcnM7XG4gICAgc2VsZi4kID0gb3ZlcmxheS4kO1xuICAgIHNlbGYub3ZlcmxheSA9IG92ZXJsYXk7XG5cbiAgICBvdmVybGF5LmdldEJvdW5kcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBnbUVsZW1lbnQoJ0xhdExuZ0JvdW5kcycsIGJvdW5kcy5nZXRTb3V0aFdlc3QoKSwgYm91bmRzLmdldE5vcnRoRWFzdCgpKTtcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIENsdXN0ZXIgR3JvdXAgZGVmaW5pdGlvbi5cbiAgICogQHR5cGVkZWYge09iamVjdH0gQ2x1c3Rlckdyb3VwRGVmXG4gICAqIEBwcm9wZXJ0eSB7U3RyaW5nfGpRdWVyeX0gY29udGVudFxuICAgKiBAcHJvcGVydHkge051bWJlcn0gW3hdIE9mZnNldFxuICAgKiBAcHJvcGVydHkge051bWJlcn0gW3ldIE9mZnNldFxuICAgKi9cblxuICAvKipcbiAgICogQ2x1c3RlciBldmFsdWF0aW9uIGZ1bmN0aW9uXG4gICAqIEBjYWxsYmFjayBjbHVzdGVyQ2FsbGJhY2tcbiAgICogQHBhcmFtIHtNYXJrZXJbXX0gbWFya2Vyc1xuICAgKiBAcmV0dXJuIHtDbHVzdGVyR3JvdXBEZWZ8dW5kZWZpbmVkfVxuICAgKi9cblxuICAvKipcbiAgICogQ2xhc3MgdXNlZCB0byBoYW5kbGUgY2x1c3RlcmluZ1xuICAgKiBAcGFyYW0ge01hcH0gbWFwXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zXG4gICAqIEBwYXJhbSB7SW50ZWdlcn0gW29wdGlvbnMuc2l6ZV1cbiAgICogQHBhcmFtIHtPYmplY3RbXX0gW29wdGlvbnMubWFya2Vyc10gbWFya2VycyBkZWZpbml0aW9uXG4gICAqIEBwYXJhbSB7Y2x1c3RlckNhbGxiYWNrfSBbb3B0aW9ucy5jYl0gY2FsbGJhY2sgdXNlZCB0byBldmFsdWF0ZSBjbHVzdGVyaW5nIGVsZW1lbnRzXG4gICAqIEBjb25zdHJ1Y3RvclxuICAgKi9cbiAgZnVuY3Rpb24gQ2x1c3RlcihtYXAsIG9wdGlvbnMpIHtcbiAgICB2YXIgdGltZXIsIGlnbml0ZXIsIHByZXZpb3VzVmlld0hhc2gsIHByb2plY3Rpb24sIGZpbHRlcixcbiAgICAgIHNlbGYgPSB0aGlzLFxuICAgICAgbWFya2VycyA9IFtdLFxuICAgICAgcmFkaXVzID0gKG9wdGlvbnMuc2l6ZSB8fCAyMDApID4+IDEsXG4gICAgICBlbmFibGVkID0gdHJ1ZSxcbiAgICAgIG92ZXJsYXlzID0ge30sXG4gICAgICBoYW5kbGVycyA9IFtdO1xuXG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gICAgb3B0aW9ucy5tYXJrZXJzID0gb3B0aW9ucy5tYXJrZXJzIHx8IFtdO1xuXG4gICAgLyoqXG4gICAgICogQ2x1c3RlciBldmFsdWF0aW9uIGZ1bmN0aW9uXG4gICAgICogQGNhbGxiYWNrIGJpbmRDYWxsYmFja1xuICAgICAqIEBwYXJhbSB7Q2x1c3Rlck92ZXJsYXlbXX0gaW5zdGFuY2VzXG4gICAgICovXG5cbiAgICAvKipcbiAgICAgKiBCaW5kIGEgZnVuY3Rpb24gdG8gZWFjaCBjdXJyZW50IG9yIGZ1dHVyZSBvdmVybGF5c1xuICAgICAqIEBwYXJhbSB7YmluZENhbGxiYWNrfSBmblxuICAgICAqL1xuICAgIHNlbGYuX2IgPSBmdW5jdGlvbiAoZm4pIHtcbiAgICAgIGZuKG9iamVjdFZhbHVlcyhvdmVybGF5cykpO1xuICAgICAgaGFuZGxlcnMucHVzaChmbik7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgbWFya2VyIGxpc3RcbiAgICAgKiBAcmV0dXJucyB7TWFya2VyW119XG4gICAgICovXG4gICAgc2VsZi5tYXJrZXJzID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHNsaWNlKG1hcmtlcnMpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGN1cnJlbnQgZ3JvdXBzXG4gICAgICogQHJldHVybnMge0NsdXN0ZXJPdmVybGF5W119XG4gICAgICovXG4gICAgc2VsZi5ncm91cHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gb2JqZWN0VmFsdWVzKG92ZXJsYXlzKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogRW5hYmxlIHRoZSBjbHVzdGVyaW5nIGZlYXR1cmVcbiAgICAgKi9cbiAgICBzZWxmLmVuYWJsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICghZW5hYmxlZCkge1xuICAgICAgICBlbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgcHJldmlvdXNWaWV3SGFzaCA9ICcnO1xuICAgICAgICBkZWxheVJlZHJhdygpO1xuICAgICAgfVxuICAgIH07XG5cblxuICAgIC8qKlxuICAgICAqIERpc2FibGUgdGhlIGNsdXN0ZXJpbmcgZmVhdHVyZVxuICAgICAqL1xuICAgIHNlbGYuZGlzYWJsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmIChlbmFibGVkKSB7XG4gICAgICAgIGVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgcHJldmlvdXNWaWV3SGFzaCA9ICcnO1xuICAgICAgICBkZWxheVJlZHJhdygpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBBZGQgYSBtYXJrZXJcbiAgICAgKiBAcGFyYW0ge01hcmtlcn0gbWFya2VyXG4gICAgICovXG4gICAgc2VsZi5hZGQgPSBmdW5jdGlvbiAobWFya2VyKSB7XG4gICAgICBtYXJrZXJzLnB1c2gobWFya2VyKTtcbiAgICAgIHByZXZpb3VzVmlld0hhc2ggPSAnJztcbiAgICAgIGRlbGF5UmVkcmF3KCk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFJlbW92ZSBhIG1hcmtlclxuICAgICAqIEBwYXJhbSB7TWFya2VyfSBtYXJrZXJcbiAgICAgKi9cbiAgICBzZWxmLnJlbW92ZSA9IGZ1bmN0aW9uIChtYXJrZXIpIHtcbiAgICAgIG1hcmtlcnMgPSBtYXJrZXJzLmZpbHRlcihmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICByZXR1cm4gaXRlbSAhPT0gbWFya2VyO1xuICAgICAgfSk7XG4gICAgICBwcmV2aW91c1ZpZXdIYXNoID0gJyc7XG4gICAgICBkZWxheVJlZHJhdygpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBGaWx0ZXJpbmcgZnVuY3Rpb24sIENsdXN0ZXIgb25seSBoYW5kbGUgdGhvc2Ugd2hvIHJldHVybiB0cnVlXG4gICAgICogQGNhbGxiYWNrIGZpbHRlckNhbGxiYWNrXG4gICAgICogQHBhcmFtIHtNYXJrZXJ9IG1hcmtlclxuICAgICAqIEByZXR1cm5zIHtCb29sZWFufVxuICAgICAqL1xuXG4gICAgLyoqXG4gICAgICogU2V0IGEgZmlsdGVyIGZ1bmN0aW9uXG4gICAgICogQHBhcmFtIHtmaWx0ZXJDYWxsYmFja30gZm5cbiAgICAgKi9cbiAgICBzZWxmLmZpbHRlciA9IGZ1bmN0aW9uIChmbikge1xuICAgICAgaWYgKGZpbHRlciAhPT0gZm4pIHtcbiAgICAgICAgZmlsdGVyID0gZm47XG4gICAgICAgIHByZXZpb3VzVmlld0hhc2ggPSAnJztcbiAgICAgICAgZGVsYXlSZWRyYXcoKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogR2VuZXJhdGUgZXh0ZW5kZWQgdmlzaWJsZSBib3VuZHNcbiAgICAgKiBAcmV0dXJucyB7TGF0TG5nQm91bmRzfVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGV4dGVuZHNNYXBCb3VuZHMoKSB7XG4gICAgICB2YXIgY2lyY2xlID0gZ21FbGVtZW50KCdDaXJjbGUnLCB7XG4gICAgICAgIGNlbnRlcjogbWFwLmdldENlbnRlcigpLFxuICAgICAgICByYWRpdXM6IDEuMTUgKiBkaXN0YW5jZUluTWV0ZXIobWFwLmdldENlbnRlcigpLCBtYXAuZ2V0Qm91bmRzKCkuZ2V0Tm9ydGhFYXN0KCkpIC8vICsgMTUlXG4gICAgICB9KTtcbiAgICAgIHJldHVybiBjaXJjbGUuZ2V0Qm91bmRzKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2VuZXJhdGUgYm91bmRzIGV4dGVuZGVkIGJ5IHJhZGl1c1xuICAgICAqIEBwYXJhbSB7TGF0TG5nfSBsYXRMbmdcbiAgICAgKiBAcmV0dXJucyB7TGF0TG5nQm91bmRzfVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGV4dGVuZHNCb3VuZHMobGF0TG5nKSB7XG4gICAgICB2YXIgcCA9IHByb2plY3Rpb24uZnJvbUxhdExuZ1RvRGl2UGl4ZWwobGF0TG5nKTtcbiAgICAgIHJldHVybiBnbUVsZW1lbnQoJ0xhdExuZ0JvdW5kcycsXG4gICAgICAgIHByb2plY3Rpb24uZnJvbURpdlBpeGVsVG9MYXRMbmcoZ21FbGVtZW50KCdQb2ludCcsIHAueCAtIHJhZGl1cywgcC55ICsgcmFkaXVzKSksXG4gICAgICAgIHByb2plY3Rpb24uZnJvbURpdlBpeGVsVG9MYXRMbmcoZ21FbGVtZW50KCdQb2ludCcsIHAueCArIHJhZGl1cywgcC55IC0gcmFkaXVzKSlcbiAgICAgICk7XG4gICAgfVxuXG4gICAgb3B0aW9ucy5tYXJrZXJzLm1hcChmdW5jdGlvbiAob3B0cykge1xuICAgICAgb3B0cy5wb3NpdGlvbiA9IHRvTGF0TG5nKG9wdHMucG9zaXRpb24pO1xuICAgICAgbWFya2Vycy5wdXNoKGdtRWxlbWVudCgnTWFya2VyJywgb3B0cykpO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmVkcmF3IGNsdXN0ZXJzXG4gICAgICovXG4gICAgZnVuY3Rpb24gcmVkcmF3KCkge1xuICAgICAgdmFyIGtleXMsIGJvdW5kcywgb3ZlcmxheU9wdGlvbnMsIGhhc2gsIGN1cnJlbnRNYXJrZXJzLCB2aWV3SGFzaCxcbiAgICAgICAgem9vbSA9IG1hcC5nZXRab29tKCksXG4gICAgICAgIGN1cnJlbnRIYXNoZXMgPSB7fSxcbiAgICAgICAgbmV3T3ZlcmxheXMgPSBbXSxcbiAgICAgICAgaWdub3JlID0ge307XG5cbiAgICAgIHZpZXdIYXNoID0gJycgKyB6b29tO1xuXG4gICAgICBpZiAoem9vbSA+IDMpIHtcbiAgICAgICAgYm91bmRzID0gZXh0ZW5kc01hcEJvdW5kcygpO1xuICAgICAgICBmb3JlYWNoKG1hcmtlcnMsIGZ1bmN0aW9uIChtYXJrZXIsIGluZGV4KSB7XG4gICAgICAgICAgaWYgKCFib3VuZHMuY29udGFpbnMobWFya2VyLmdldFBvc2l0aW9uKCkpKSB7XG4gICAgICAgICAgICB2aWV3SGFzaCArPSAnLScgKyBpbmRleDtcbiAgICAgICAgICAgIGlnbm9yZVtpbmRleF0gPSB0cnVlO1xuICAgICAgICAgICAgaWYgKG1hcmtlci5nZXRNYXAoKSkge1xuICAgICAgICAgICAgICBtYXJrZXIuc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBpZiAoZmlsdGVyKSB7XG4gICAgICAgIGZvcmVhY2gobWFya2VycywgZnVuY3Rpb24gKG1hcmtlciwgaW5kZXgpIHtcbiAgICAgICAgICBpZiAoIWlnbm9yZVtpbmRleF0gJiYgIWZpbHRlcihtYXJrZXIpKSB7XG4gICAgICAgICAgICB2aWV3SGFzaCArPSAnLScgKyBpbmRleDtcbiAgICAgICAgICAgIGlnbm9yZVtpbmRleF0gPSB0cnVlO1xuICAgICAgICAgICAgaWYgKG1hcmtlci5nZXRNYXAoKSkge1xuICAgICAgICAgICAgICBtYXJrZXIuc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGlmICh2aWV3SGFzaCA9PT0gcHJldmlvdXNWaWV3SGFzaCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBwcmV2aW91c1ZpZXdIYXNoID0gdmlld0hhc2g7XG5cbiAgICAgIGZvcmVhY2gobWFya2VycywgZnVuY3Rpb24gKG1hcmtlciwgaW5kZXgpIHtcbiAgICAgICAgaWYgKGlnbm9yZVtpbmRleF0pIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBrZXlzID0gW2luZGV4XTtcbiAgICAgICAgYm91bmRzID0gZXh0ZW5kc0JvdW5kcyhtYXJrZXIuZ2V0UG9zaXRpb24oKSk7XG5cbiAgICAgICAgaWYgKGVuYWJsZWQpIHtcbiAgICAgICAgICBmb3JlYWNoKHNsaWNlKG1hcmtlcnMsIGluZGV4ICsgMSksIGZ1bmN0aW9uIChtYXJrZXIsIGlkeCkge1xuICAgICAgICAgICAgaWR4ICs9IGluZGV4ICsgMTtcbiAgICAgICAgICAgIGlmICghaWdub3JlW2lkeF0gJiYgYm91bmRzLmNvbnRhaW5zKG1hcmtlci5nZXRQb3NpdGlvbigpKSkge1xuICAgICAgICAgICAgICBrZXlzLnB1c2goaWR4KTtcbiAgICAgICAgICAgICAgaWdub3JlW2lkeF0gPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgaGFzaCA9IGtleXMuam9pbignLScpO1xuICAgICAgICBjdXJyZW50SGFzaGVzW2hhc2hdID0gdHJ1ZTtcblxuICAgICAgICBpZiAob3ZlcmxheXNbaGFzaF0pIHsgLy8gaGFzaCBpcyBhbHJlYWR5IHNldFxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGN1cnJlbnRNYXJrZXJzID0ga2V5cy5tYXAoZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgIHJldHVybiBtYXJrZXJzW2tleV07XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIGFzayB0aGUgdXNlciBjYWxsYmFjayBvbiB0aGlzIHN1YnNldCAobWF5IGJlIGNvbXBvc2VkIGJ5IG9ubHkgb25lIG1hcmtlcilcbiAgICAgICAgb3ZlcmxheU9wdGlvbnMgPSBvcHRpb25zLmNiKHNsaWNlKGN1cnJlbnRNYXJrZXJzKSk7XG5cbiAgICAgICAgLy8gY3JlYXRlIGFuIG92ZXJsYXkgaWYgY2IgcmV0dXJucyBpdHMgcHJvcGVydGllc1xuICAgICAgICBpZiAob3ZlcmxheU9wdGlvbnMpIHtcbiAgICAgICAgICBib3VuZHMgPSBnbUVsZW1lbnQoJ0xhdExuZ0JvdW5kcycpO1xuICAgICAgICAgIGZvcmVhY2goY3VycmVudE1hcmtlcnMsIGZ1bmN0aW9uIChtYXJrZXIpIHtcbiAgICAgICAgICAgIGJvdW5kcy5leHRlbmQobWFya2VyLmdldFBvc2l0aW9uKCkpO1xuICAgICAgICAgICAgaWYgKG1hcmtlci5nZXRNYXAoKSkge1xuICAgICAgICAgICAgICBtYXJrZXIuc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgb3ZlcmxheU9wdGlvbnMgPSBkdXBPcHRzKG92ZXJsYXlPcHRpb25zKTtcbiAgICAgICAgICBvdmVybGF5T3B0aW9ucy5wb3NpdGlvbiA9IGJvdW5kcy5nZXRDZW50ZXIoKTtcbiAgICAgICAgICBvdmVybGF5c1toYXNoXSA9IG5ldyBDbHVzdGVyT3ZlcmxheShzZWxmLCBzbGljZShjdXJyZW50TWFya2VycyksIGNyZWF0ZU92ZXJsYXlWaWV3KG1hcCwgb3ZlcmxheU9wdGlvbnMpLCBib3VuZHMpO1xuICAgICAgICAgIG5ld092ZXJsYXlzLnB1c2gob3ZlcmxheXNbaGFzaF0pO1xuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZm9yZWFjaChjdXJyZW50TWFya2VycywgZnVuY3Rpb24gKG1hcmtlcikge1xuICAgICAgICAgICAgaWYgKCFtYXJrZXIuZ2V0TWFwKCkpIHsgLy8gdG8gYXZvaWQgbWFya2VyIGJsaW5raW5nXG4gICAgICAgICAgICAgIG1hcmtlci5zZXRNYXAobWFwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICB9KTtcblxuICAgICAgLy8gcmVtb3ZlIHByZXZpb3VzIG92ZXJsYXlzXG4gICAgICBmb3JlYWNoKG9iamVjdEtleXMob3ZlcmxheXMpLCBmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIGlmICghY3VycmVudEhhc2hlc1trZXldKSB7XG4gICAgICAgICAgb3ZlcmxheXNba2V5XS5vdmVybGF5LnNldE1hcChudWxsKTtcbiAgICAgICAgICBkZWxldGUgb3ZlcmxheXNba2V5XTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGlmIChuZXdPdmVybGF5cy5sZW5ndGgpIHtcbiAgICAgICAgZm9yZWFjaChoYW5kbGVycywgZnVuY3Rpb24gKGZuKSB7XG4gICAgICAgICAgZm4obmV3T3ZlcmxheXMpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXN0YXJ0IHJlZHJhdyB0aW1lclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGRlbGF5UmVkcmF3KCkge1xuICAgICAgY2xlYXJUaW1lb3V0KHRpbWVyKTtcbiAgICAgIHRpbWVyID0gc2V0VGltZW91dChyZWRyYXcsIDEwMCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSW5pdCBjbHVzdGVyaW5nXG4gICAgICovXG4gICAgZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgIGdtLmV2ZW50LmFkZExpc3RlbmVyKG1hcCwgXCJ6b29tX2NoYW5nZWRcIiwgZGVsYXlSZWRyYXcpO1xuICAgICAgZ20uZXZlbnQuYWRkTGlzdGVuZXIobWFwLCBcImJvdW5kc19jaGFuZ2VkXCIsIGRlbGF5UmVkcmF3KTtcbiAgICAgIHJlZHJhdygpO1xuICAgIH1cblxuICAgIGlnbml0ZXIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICBwcm9qZWN0aW9uID0gZ2V0UHJvamVjdGlvbihtYXApO1xuICAgICAgaWYgKHByb2plY3Rpb24pIHtcbiAgICAgICAgY2xlYXJJbnRlcnZhbChpZ25pdGVyKTtcbiAgICAgICAgaW5pdCgpO1xuICAgICAgfVxuICAgIH0sIDEwKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDb25maWd1cmUgZ29vZ2xlIG1hcHMgbG9hZGluZyBsaWJyYXJ5XG4gICAqIEBwYXJhbSB7c3RyaW5nfG9iamVjdH0gb3B0aW9uc1xuICAgKi9cbiAgJC5nbWFwMyA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gICAgbG9hZE9wdGlvbnMgPSBvcHRpb25zO1xuICB9O1xuXG4gIC8qKlxuICAgKiBqUXVlcnkgUGx1Z2luXG4gICAqL1xuICAkLmZuLmdtYXAzID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICB2YXIgaXRlbXMgPSBbXTtcbiAgICBnbSA9IHdpbmRvdy5nb29nbGUubWFwczsgLy8gb25jZSBnbWFwMyBpcyBsb2FkZWQsIGdvb2dsZS5tYXBzIGxpYnJhcnkgc2hvdWxkIGJlIGxvYWRlZFxuICAgIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgJHRoaXMgPSAkKHRoaXMpLCBnbWFwMyA9ICR0aGlzLmRhdGEoXCJnbWFwM1wiKTtcbiAgICAgIGlmICghZ21hcDMpIHtcbiAgICAgICAgZ21hcDMgPSBuZXcgR21hcDMoJHRoaXMsIG9wdGlvbnMpO1xuICAgICAgICAkdGhpcy5kYXRhKFwiZ21hcDNcIiwgZ21hcDMpO1xuICAgICAgfVxuICAgICAgaXRlbXMucHVzaChnbWFwMyk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gbmV3IEhhbmRsZXIodGhpcywgaXRlbXMpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBDbGFzcyBIYW5kbGVyXG4gICAqIENoYWluYWJsZSBvYmpldCB3aGljaCBoYW5kbGUgYWxsIEdtYXAzIGl0ZW1zIGFzc29jaWF0ZWQgdG8gYWxsIGpRdWVyeSBlbGVtZW50cyBpbiB0aGUgY3VycmVudCBjb21tYW5kIHNldFxuICAgKiBAcGFyYW0ge2pRdWVyeX0gY2hhaW4gLSBcInRoaXNcIiB0byByZXR1cm4gdG8gbWFpbnRhaW4gdGhlIGpRdWVyeSBjaGFpblxuICAgKiBAcGFyYW0ge0dtYXAzW119IGl0ZW1zXG4gICAqIEBjb25zdHJ1Y3RvclxuICAgKi9cbiAgZnVuY3Rpb24gSGFuZGxlcihjaGFpbiwgaXRlbXMpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICAvLyBNYXAgYWxsIGZ1bmN0aW9ucyBmcm9tIEdtYXAzIGNsYXNzXG4gICAgb2JqZWN0S2V5cyhpdGVtc1swXSkuZm9yRWFjaChmdW5jdGlvbiAobmFtZSkge1xuICAgICAgc2VsZltuYW1lXSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHJlc3VsdHMgPSBbXSxcbiAgICAgICAgICBhcmdzID0gc2xpY2UoYXJndW1lbnRzKTtcbiAgICAgICAgaXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgIHJlc3VsdHMucHVzaChpdGVtW25hbWVdLmFwcGx5KGl0ZW0sIGFyZ3MpKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBuYW1lID09PSAnZ2V0JyA/IChyZXN1bHRzLmxlbmd0aCA+IDEgPyByZXN1bHRzIDogcmVzdWx0c1swXSkgOiBzZWxmO1xuICAgICAgfTtcbiAgICB9KTtcblxuICAgIHNlbGYuJCA9IGNoYWluO1xuICB9XG5cbiAgLyoqXG4gICAqIENsYXNzIEdtYXAzXG4gICAqIEhhbmRsZSBhIEdvb2dsZS5tYXBzLk1hcCBpbnN0YW5jZVxuICAgKiBAcGFyYW0ge2pRdWVyeX0gJGNvbnRhaW5lciAtIEVsZW1lbnQgdG8gZGlzcGxheSB0aGUgbWFwIGluXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIC0gTWFwT3B0aW9uc1xuICAgKiBAY29uc3RydWN0b3JcbiAgICovXG4gIGZ1bmN0aW9uIEdtYXAzKCRjb250YWluZXIsIG9wdGlvbnMpIHtcbiAgICB2YXIgbWFwLFxuICAgICAgcHJldmlvdXNSZXN1bHRzID0gW10sXG4gICAgICBwcm9taXNlID0gd2hlbigpLFxuICAgICAgc2VsZiA9IHRoaXM7XG5cbiAgICBmdW5jdGlvbiBjb250ZXh0KCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgJDogJGNvbnRhaW5lcixcbiAgICAgICAgZ2V0OiBzZWxmLmdldFxuICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBdHRhY2ggZXZlbnRzIHRvIGluc3RhbmNlc1xuICAgICAqIEBwYXJhbSB7T2JqZWN0IH0gZXZlbnRzXG4gICAgICogQHBhcmFtIHtBcnJheXxPYmplY3R9IGluc3RhbmNlc1xuICAgICAqIEBwYXJhbSB7YXJyYXl9IFthcmdzXSBhcmd1bWVudHMgdG8gYWRkXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBvbmNlXG4gICAgICovXG4gICAgZnVuY3Rpb24gYXR0YWNoRXZlbnRzKGV2ZW50cywgaW5zdGFuY2VzLCBhcmdzLCBvbmNlKSB7XG4gICAgICB2YXIgaGFzQXJncyA9IGFyZ3VtZW50cy5sZW5ndGggPiAzO1xuICAgICAgaWYgKCFoYXNBcmdzKSB7XG4gICAgICAgIG9uY2UgPSBhcmdzO1xuICAgICAgfVxuICAgICAgJC5lYWNoKGV2ZW50cywgZnVuY3Rpb24gKGV2ZW50TmFtZSwgaGFuZGxlcnMpIHtcbiAgICAgICAgZm9yZWFjaChpbnN0YW5jZXMsIGZ1bmN0aW9uIChpbnN0YW5jZSkge1xuICAgICAgICAgIHZhciBpc0NsdXN0ZXJPdmVybGF5ID0gaW5zdGFuY2UgaW5zdGFuY2VvZiBDbHVzdGVyT3ZlcmxheTtcbiAgICAgICAgICB2YXIgaXNEb20gPSBpc0NsdXN0ZXJPdmVybGF5IHx8wqAoaW5zdGFuY2UgaW5zdGFuY2VvZiBnbS5PdmVybGF5Vmlldyk7XG4gICAgICAgICAgdmFyIGV2ZW50TGlzdGVuZXIgPSBpc0RvbSA/IGluc3RhbmNlLiQuZ2V0KDApIDogaW5zdGFuY2U7XG4gICAgICAgICAgZ20uZXZlbnRbJ2FkZCcgKyAoaXNEb20gPyAnRG9tJyA6ICcnKSArICdMaXN0ZW5lcicgKyAob25jZSA/ICdPbmNlJyA6ICcnKV0oZXZlbnRMaXN0ZW5lciwgZXZlbnROYW1lLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgIGZvcmVhY2goaGFuZGxlcnMsIGZ1bmN0aW9uIChoYW5kbGVyKSB7XG4gICAgICAgICAgICAgIGlmIChpc0Z1bmN0aW9uKGhhbmRsZXIpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGlzQ2x1c3Rlck92ZXJsYXkpIHtcbiAgICAgICAgICAgICAgICAgIGhhbmRsZXIuY2FsbChjb250ZXh0KCksIHVuZGVmaW5lZCAvKiBtYXJrZXIgKi8sIGluc3RhbmNlLCBpbnN0YW5jZS5jbHVzdGVyLCBldmVudCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChoYXNBcmdzKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgYnVmZmVyID0gc2xpY2UoYXJncyk7XG4gICAgICAgICAgICAgICAgICBidWZmZXIudW5zaGlmdChpbnN0YW5jZSk7XG4gICAgICAgICAgICAgICAgICBidWZmZXIucHVzaChldmVudCk7XG4gICAgICAgICAgICAgICAgICBoYW5kbGVyLmFwcGx5KGNvbnRleHQoKSwgYnVmZmVyKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgaGFuZGxlci5jYWxsKGNvbnRleHQoKSwgaW5zdGFuY2UsIGV2ZW50KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERlY29yYXRvciB0byBoYW5kbGUgbXVsdGlwbGUgY2FsbCBiYXNlZCBvbiBhcnJheSBvZiBvcHRpb25zXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm5cbiAgICAgKiBAcmV0dXJucyB7RGVmZXJyZWR9XG4gICAgICovXG4gICAgZnVuY3Rpb24gbXVsdGlwbGUoZm4pIHtcbiAgICAgIHJldHVybiBmdW5jdGlvbiAob3B0aW9ucykge1xuICAgICAgICBpZiAoaXNBcnJheShvcHRpb25zKSkge1xuICAgICAgICAgIHZhciBpbnN0YW5jZXMgPSBbXTtcbiAgICAgICAgICB2YXIgcHJvbWlzZXMgPSBvcHRpb25zLm1hcChmdW5jdGlvbiAob3B0cykge1xuICAgICAgICAgICAgcmV0dXJuIGZuLmNhbGwoc2VsZiwgb3B0cykudGhlbihmdW5jdGlvbiAoaW5zdGFuY2UpIHtcbiAgICAgICAgICAgICAgaW5zdGFuY2VzLnB1c2goaW5zdGFuY2UpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcmV0dXJuIGFsbChwcm9taXNlcykudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBwcmV2aW91c1Jlc3VsdHMucHVzaChpbnN0YW5jZXMpO1xuICAgICAgICAgICAgcmV0dXJuIGluc3RhbmNlcztcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gZm4uYXBwbHkoc2VsZiwgYXJndW1lbnRzKS50aGVuKGZ1bmN0aW9uIChpbnN0YW5jZSkge1xuICAgICAgICAgICAgcHJldmlvdXNSZXN1bHRzLnB1c2goaW5zdGFuY2UpO1xuICAgICAgICAgICAgcmV0dXJuIGluc3RhbmNlO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERlY29yYXRvciB0byBjaGFpbiBwcm9taXNlIHJlc3VsdCBvbnRvIHRoZSBtYWluIHByb21pc2UgY2hhaW5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmblxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjaGFpblRvUHJvbWlzZShmbikge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSBzbGljZShhcmd1bWVudHMpO1xuICAgICAgICBwcm9taXNlID0gcHJvbWlzZS50aGVuKGZ1bmN0aW9uIChpbnN0YW5jZSkge1xuICAgICAgICAgIGlmIChpc0Z1bmN0aW9uKGFyZ3NbMF0pKSB7XG4gICAgICAgICAgICAvLyBoYW5kbGUgcmV0dXJuIGFzIGEgZGVmZXJyZWQgLyBwcm9taXNlIHRvIHN1cHBvcnQgYm90aCBzeW5jICYgYXN5bmMgcmVzdWx0XG4gICAgICAgICAgICByZXR1cm4gd2hlbihhcmdzWzBdLmNhbGwoY29udGV4dCgpLCBpbnN0YW5jZSkpLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICAgIGFyZ3NbMF0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgcmV0dXJuIGZuLmFwcGx5KHNlbGYsIGFyZ3MpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIHdoZW4oZm4uYXBwbHkoc2VsZiwgYXJncykpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICB9O1xuICAgIH1cblxuICAgIHNlbGYubWFwID0gY2hhaW5Ub1Byb21pc2UoZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICAgIHJldHVybiBtYXAgfHwgcmVzb2x2ZUxhdExuZyhvcHRpb25zLCAnY2VudGVyJywgZnVuY3Rpb24gKG9wdHMpIHtcbiAgICAgICAgICBtYXAgPSBnbUVsZW1lbnQoJ01hcCcsICRjb250YWluZXIuZ2V0KDApLCBvcHRzKTtcbiAgICAgICAgICBwcmV2aW91c1Jlc3VsdHMucHVzaChtYXApO1xuICAgICAgICAgIHJldHVybiBtYXA7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgLy8gU3BhY2Ugc2VwYXJhdGVkIHN0cmluZyBvZiA6IHNlcGFyYXRlZCBlbGVtZW50XG4gICAgLy8gKGdvb2dsZS5tYXBzIGNsYXNzIG5hbWUpIDogKGxhdExuZyBwcm9wZXJ0eSBuYW1lKSA6IChhZGQgbWFwIC0gMHwxIC0gZGVmYXVsdCA9IDEpXG4gICAgZm9yZWFjaFN0cignTWFya2VyOnBvc2l0aW9uIENpcmNsZTpjZW50ZXIgSW5mb1dpbmRvdzpwb3NpdGlvbjowIFBvbHlsaW5lOnBhdGggUG9seWdvbjpwYXRocycsIGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICBpdGVtID0gaXRlbS5zcGxpdCgnOicpO1xuICAgICAgdmFyIHByb3BlcnR5ID0gaXRlbVsxXSB8fCAnJztcbiAgICAgIHNlbGZbaXRlbVswXS50b0xvd2VyQ2FzZSgpXSA9IGNoYWluVG9Qcm9taXNlKG11bHRpcGxlKGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gICAgICAgIHJldHVybiAocHJvcGVydHkubWF0Y2goL15wYXRoLykgPyByZXNvbHZlQXJyYXlPZkxhdExuZyA6IHJlc29sdmVMYXRMbmcpKG9wdGlvbnMsIHByb3BlcnR5LCBmdW5jdGlvbiAob3B0cykge1xuICAgICAgICAgIGlmIChpdGVtWzJdICE9PSAnMCcpIHtcbiAgICAgICAgICAgIG9wdHMubWFwID0gbWFwO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gZ21FbGVtZW50KGl0ZW1bMF0sIG9wdHMpO1xuICAgICAgICB9KTtcbiAgICAgIH0pKTtcbiAgICB9KTtcblxuICAgIGZvcmVhY2hTdHIoJ1RyYWZmaWNMYXllciBUcmFuc2l0TGF5ZXIgQmljeWNsaW5nTGF5ZXInLCBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgc2VsZltpdGVtLnRvTG93ZXJDYXNlKCldID0gY2hhaW5Ub1Byb21pc2UoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgaW5zdGFuY2UgPSBnbUVsZW1lbnQoaXRlbSk7XG4gICAgICAgIHByZXZpb3VzUmVzdWx0cy5wdXNoKGluc3RhbmNlKTtcbiAgICAgICAgaW5zdGFuY2Uuc2V0TWFwKG1hcCk7XG4gICAgICAgIHJldHVybiBpbnN0YW5jZTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgc2VsZi5rbWxsYXllciA9IGNoYWluVG9Qcm9taXNlKG11bHRpcGxlKGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gICAgICBvcHRpb25zID0gZHVwT3B0cyhvcHRpb25zKTtcbiAgICAgIG9wdGlvbnMubWFwID0gbWFwO1xuICAgICAgcmV0dXJuIHdoZW4oZ21FbGVtZW50KCdLbWxMYXllcicsIG9wdGlvbnMpKTtcbiAgICB9KSk7XG5cbiAgICBzZWxmLnJlY3RhbmdsZSA9IGNoYWluVG9Qcm9taXNlKG11bHRpcGxlKGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gICAgICByZXR1cm4gcmVzb2x2ZUxhdExuZ0JvdW5kcyhvcHRpb25zLCBmdW5jdGlvbiAob3B0cykge1xuICAgICAgICBvcHRzLm1hcCA9IG1hcDtcbiAgICAgICAgcmV0dXJuIGdtRWxlbWVudCgnUmVjdGFuZ2xlJywgb3B0cyk7XG4gICAgICB9KTtcbiAgICB9KSk7XG5cbiAgICBzZWxmLm92ZXJsYXkgPSBjaGFpblRvUHJvbWlzZShtdWx0aXBsZShmdW5jdGlvbiAob3B0aW9ucykge1xuICAgICAgZnVuY3Rpb24gZm4ob3B0cykge1xuICAgICAgICByZXR1cm4gY3JlYXRlT3ZlcmxheVZpZXcobWFwLCBvcHRzKTtcbiAgICAgIH1cblxuICAgICAgb3B0aW9ucyA9IGR1cE9wdHMob3B0aW9ucyk7XG4gICAgICByZXR1cm4gb3B0aW9ucy5ib3VuZHMgPyByZXNvbHZlTGF0TG5nQm91bmRzKG9wdGlvbnMsIGZuKSA6IHJlc29sdmVMYXRMbmcob3B0aW9ucywgJ3Bvc2l0aW9uJywgZm4pO1xuICAgIH0pKTtcblxuICAgIHNlbGYuZ3JvdW5kb3ZlcmxheSA9IGNoYWluVG9Qcm9taXNlKGZ1bmN0aW9uICh1cmwsIGJvdW5kcywgb3B0aW9ucykge1xuICAgICAgcmV0dXJuIHJlc29sdmVMYXRMbmdCb3VuZHMoe2JvdW5kczogYm91bmRzfSwgZnVuY3Rpb24gKG9wdHMpIHtcbiAgICAgICAgb3B0aW9ucyA9IGR1cE9wdHMob3B0aW9ucyk7XG4gICAgICAgIG9wdGlvbnMubWFwID0gbWFwO1xuICAgICAgICB2YXIgaW5zdGFuY2UgPSBnbUVsZW1lbnQoJ0dyb3VuZE92ZXJsYXknLCB1cmwsIG9wdHMuYm91bmRzLCBvcHRpb25zKTtcbiAgICAgICAgcHJldmlvdXNSZXN1bHRzLnB1c2goaW5zdGFuY2UpO1xuICAgICAgICByZXR1cm4gaW5zdGFuY2U7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIHNlbGYuc3R5bGVkbWFwdHlwZSA9IGNoYWluVG9Qcm9taXNlKGZ1bmN0aW9uIChzdHlsZUlkLCBzdHlsZXMsIG9wdGlvbnMpIHtcbiAgICAgIHZhciBpbnN0YW5jZSA9IGdtRWxlbWVudCgnU3R5bGVkTWFwVHlwZScsIHN0eWxlcywgb3B0aW9ucyk7XG4gICAgICBwcmV2aW91c1Jlc3VsdHMucHVzaChpbnN0YW5jZSk7XG4gICAgICBtYXAubWFwVHlwZXMuc2V0KHN0eWxlSWQsIGluc3RhbmNlKTtcbiAgICAgIHJldHVybiBpbnN0YW5jZTtcbiAgICB9KTtcblxuICAgIHNlbGYuc3RyZWV0dmlld3Bhbm9yYW1hID0gY2hhaW5Ub1Byb21pc2UoZnVuY3Rpb24gKGNvbnRhaW5lciwgb3B0aW9ucykge1xuICAgICAgcmV0dXJuIHJlc29sdmVMYXRMbmcob3B0aW9ucywgJ3Bvc2l0aW9uJywgZnVuY3Rpb24gKG9wdHMpIHtcbiAgICAgICAgdmFyIGluc3RhbmNlID0gZ21FbGVtZW50KCdTdHJlZXRWaWV3UGFub3JhbWEnLCAkKGNvbnRhaW5lcikuZ2V0KDApLCBvcHRzKTtcbiAgICAgICAgbWFwLnNldFN0cmVldFZpZXcoaW5zdGFuY2UpO1xuICAgICAgICBwcmV2aW91c1Jlc3VsdHMucHVzaChpbnN0YW5jZSk7XG4gICAgICAgIHJldHVybiBpbnN0YW5jZTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgc2VsZi5yb3V0ZSA9IGNoYWluVG9Qcm9taXNlKGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gICAgICB2YXIgZGZkID0gZGVmZXJyZWQoKTtcbiAgICAgIG9wdGlvbnMgPSBkdXBPcHRzKG9wdGlvbnMpO1xuICAgICAgb3B0aW9ucy5vcmlnaW4gPSB0b0xhdExuZyhvcHRpb25zLm9yaWdpbik7XG4gICAgICBvcHRpb25zLmRlc3RpbmF0aW9uID0gdG9MYXRMbmcob3B0aW9ucy5kZXN0aW5hdGlvbik7XG4gICAgICBzZXJ2aWNlKCdEaXJlY3Rpb25zU2VydmljZScpLnJvdXRlKG9wdGlvbnMsIGZ1bmN0aW9uIChyZXN1bHRzLCBzdGF0dXMpIHtcbiAgICAgICAgcHJldmlvdXNSZXN1bHRzLnB1c2gocmVzdWx0cyk7XG4gICAgICAgIGRmZC5yZXNvbHZlKHN0YXR1cyA9PT0gZ20uRGlyZWN0aW9uc1N0YXR1cy5PSyA/IHJlc3VsdHMgOiBmYWxzZSk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBkZmQ7XG4gICAgfSk7XG5cbiAgICBzZWxmLmNsdXN0ZXIgPSBjaGFpblRvUHJvbWlzZShmdW5jdGlvbiAob3B0aW9ucykge1xuICAgICAgdmFyIGNsdXN0ZXIgPSBuZXcgQ2x1c3RlcihtYXAsIGR1cE9wdHMob3B0aW9ucykpO1xuICAgICAgcHJldmlvdXNSZXN1bHRzLnB1c2goY2x1c3Rlcik7XG4gICAgICByZXR1cm4gcmVzb2x2ZWQoY2x1c3Rlcik7XG4gICAgfSk7XG5cbiAgICBzZWxmLmRpcmVjdGlvbnNyZW5kZXJlciA9IGNoYWluVG9Qcm9taXNlKGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gICAgICB2YXIgaW5zdGFuY2U7XG4gICAgICBpZiAob3B0aW9ucykge1xuICAgICAgICBvcHRpb25zID0gZHVwT3B0cyhvcHRpb25zKTtcbiAgICAgICAgb3B0aW9ucy5tYXAgPSBtYXA7XG4gICAgICAgIGlmIChvcHRpb25zLnBhbmVsKSB7XG4gICAgICAgICAgb3B0aW9ucy5wYW5lbCA9ICQob3B0aW9ucy5wYW5lbCkuZ2V0KDApO1xuICAgICAgICB9XG4gICAgICAgIGluc3RhbmNlID0gZ21FbGVtZW50KCdEaXJlY3Rpb25zUmVuZGVyZXInLCBvcHRpb25zKTtcbiAgICAgIH1cbiAgICAgIHByZXZpb3VzUmVzdWx0cy5wdXNoKGluc3RhbmNlKTtcbiAgICAgIHJldHVybiBpbnN0YW5jZTtcbiAgICB9KTtcblxuICAgIHNlbGYubGF0bG5nID0gY2hhaW5Ub1Byb21pc2UobXVsdGlwbGUoZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICAgIHJldHVybiByZXNvbHZlTGF0TG5nKG9wdGlvbnMsICdsYXRsbmcnLCBmdW5jdGlvbiAob3B0cykge1xuICAgICAgICBwcmV2aW91c1Jlc3VsdHMucHVzaChvcHRzLmxhdGxuZyk7XG4gICAgICAgIHJldHVybiBvcHRzLmxhdGxuZztcbiAgICAgIH0pO1xuICAgIH0pKTtcblxuICAgIHNlbGYuZml0ID0gY2hhaW5Ub1Byb21pc2UoZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIGJvdW5kcyA9IGdtRWxlbWVudCgnTGF0TG5nQm91bmRzJyk7XG4gICAgICBmb3JlYWNoKHByZXZpb3VzUmVzdWx0cywgZnVuY3Rpb24gKGluc3RhbmNlcykge1xuICAgICAgICBpZiAoaW5zdGFuY2VzICE9PSBtYXApIHtcbiAgICAgICAgICBmb3JlYWNoKGluc3RhbmNlcywgZnVuY3Rpb24gKGluc3RhbmNlKSB7XG4gICAgICAgICAgICBpZiAoaW5zdGFuY2UpIHtcbiAgICAgICAgICAgICAgaWYgKGluc3RhbmNlLmdldFBvc2l0aW9uICYmIGluc3RhbmNlLmdldFBvc2l0aW9uKCkpIHtcbiAgICAgICAgICAgICAgICBib3VuZHMuZXh0ZW5kKGluc3RhbmNlLmdldFBvc2l0aW9uKCkpO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKGluc3RhbmNlLmdldEJvdW5kcyAmJiBpbnN0YW5jZS5nZXRCb3VuZHMoKSkge1xuICAgICAgICAgICAgICAgIGJvdW5kcy5leHRlbmQoaW5zdGFuY2UuZ2V0Qm91bmRzKCkuZ2V0Tm9ydGhFYXN0KCkpO1xuICAgICAgICAgICAgICAgIGJvdW5kcy5leHRlbmQoaW5zdGFuY2UuZ2V0Qm91bmRzKCkuZ2V0U291dGhXZXN0KCkpO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKGluc3RhbmNlLmdldFBhdGhzICYmIGluc3RhbmNlLmdldFBhdGhzKCkpIHtcbiAgICAgICAgICAgICAgICBmb3JlYWNoKGluc3RhbmNlLmdldFBhdGhzKCkuZ2V0QXJyYXkoKSwgZnVuY3Rpb24gKHBhdGgpIHtcbiAgICAgICAgICAgICAgICAgIGZvcmVhY2gocGF0aC5nZXRBcnJheSgpLCBmdW5jdGlvbiAobGF0TG5nKSB7XG4gICAgICAgICAgICAgICAgICAgIGJvdW5kcy5leHRlbmQobGF0TG5nKTtcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKGluc3RhbmNlLmdldFBhdGggJiYgaW5zdGFuY2UuZ2V0UGF0aCgpKSB7XG4gICAgICAgICAgICAgICAgZm9yZWFjaChpbnN0YW5jZS5nZXRQYXRoKCkuZ2V0QXJyYXkoKSwgZnVuY3Rpb24gKGxhdExuZykge1xuICAgICAgICAgICAgICAgICAgYm91bmRzLmV4dGVuZChsYXRMbmcpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKGluc3RhbmNlLmdldENlbnRlciAmJiBpbnN0YW5jZS5nZXRDZW50ZXIoKSkge1xuICAgICAgICAgICAgICAgIGJvdW5kcy5leHRlbmQoaW5zdGFuY2UuZ2V0Q2VudGVyKCkpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgaWYgKCFib3VuZHMuaXNFbXB0eSgpKSB7XG4gICAgICAgIG1hcC5maXRCb3VuZHMoYm91bmRzKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0pO1xuXG4gICAgc2VsZi53YWl0ID0gZnVuY3Rpb24gKGR1cmF0aW9uKSB7XG4gICAgICBwcm9taXNlID0gcHJvbWlzZS50aGVuKGZ1bmN0aW9uIChpbnN0YW5jZSkge1xuICAgICAgICB2YXIgZGZkID0gZGVmZXJyZWQoKTtcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgZGZkLnJlc29sdmUoaW5zdGFuY2UpO1xuICAgICAgICB9LCBkdXJhdGlvbik7XG4gICAgICAgIHJldHVybiBkZmQ7XG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgc2VsZi50aGVuID0gZnVuY3Rpb24gKGZuKSB7XG4gICAgICBpZiAoaXNGdW5jdGlvbihmbikpIHtcbiAgICAgICAgcHJvbWlzZSA9IHByb21pc2UudGhlbihmdW5jdGlvbiAoaW5zdGFuY2UpIHtcbiAgICAgICAgICByZXR1cm4gd2hlbihmbi5jYWxsKGNvbnRleHQoKSwgaW5zdGFuY2UpKS50aGVuKGZ1bmN0aW9uIChuZXdJbnN0YW5jZSkge1xuICAgICAgICAgICAgcmV0dXJuIGlzVW5kZWZpbmVkKG5ld0luc3RhbmNlKSA/IGluc3RhbmNlIDogbmV3SW5zdGFuY2U7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBzZWxmLmNhdGNoID0gZnVuY3Rpb24gKGZuKSB7XG4gICAgICBpZiAoaXNGdW5jdGlvbihmbikpIHtcbiAgICAgICAgcHJvbWlzZSA9IHByb21pc2VcbiAgICAgICAgICAudGhlbihudWxsLCBmdW5jdGlvbiAocmVhc29uKSB7XG4gICAgICAgICAgICByZXR1cm4gd2hlbihmbi5jYWxsKGNvbnRleHQoKSwgcmVhc29uKSk7XG4gICAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIGZvcmVhY2hTdHIoJ29uIG9uY2UnLCBmdW5jdGlvbiAobmFtZSwgb25jZSkge1xuICAgICAgc2VsZltuYW1lXSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGV2ZW50cyA9IGFyZ3VtZW50c1swXTtcbiAgICAgICAgaWYgKGV2ZW50cykge1xuICAgICAgICAgIGlmICh0eXBlb2YgZXZlbnRzID09PSAnc3RyaW5nJykgeyAvLyBjYXN0IGNhbGwgb24oJ2NsaWNrJywgaGFuZGxlcikgdG8gb24oe2NsaWNrOiBoYW5kbGVyfSlcbiAgICAgICAgICAgIGV2ZW50cyA9IHt9O1xuICAgICAgICAgICAgZXZlbnRzW2FyZ3VtZW50c1swXV0gPSBzbGljZShhcmd1bWVudHMsIDEpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBwcm9taXNlLnRoZW4oZnVuY3Rpb24gKGluc3RhbmNlcykge1xuICAgICAgICAgICAgaWYgKGluc3RhbmNlcykge1xuICAgICAgICAgICAgICBpZiAoaW5zdGFuY2VzIGluc3RhbmNlb2YgQ2x1c3Rlcikge1xuICAgICAgICAgICAgICAgIGluc3RhbmNlcy5fYihmdW5jdGlvbiAoaXRlbXMpIHtcbiAgICAgICAgICAgICAgICAgIGlmIChpdGVtcyAmJiBpdGVtcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgYXR0YWNoRXZlbnRzKGV2ZW50cywgaXRlbXMsIG9uY2UpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBhdHRhY2hFdmVudHMoZXZlbnRzLCBpbnN0YW5jZXMubWFya2VycygpLCBbdW5kZWZpbmVkLCBpbnN0YW5jZXNdLCBvbmNlKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBhdHRhY2hFdmVudHMoZXZlbnRzLCBpbnN0YW5jZXMsIG9uY2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH0pO1xuXG4gICAgc2VsZi5nZXQgPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgIGlmIChpc1VuZGVmaW5lZChpbmRleCkpIHtcbiAgICAgICAgcmV0dXJuIHByZXZpb3VzUmVzdWx0cy5tYXAoZnVuY3Rpb24gKGluc3RhbmNlKSB7XG4gICAgICAgICAgcmV0dXJuIGlzQXJyYXkoaW5zdGFuY2UpID8gaW5zdGFuY2Uuc2xpY2UoKSA6IGluc3RhbmNlO1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChpbmRleCA8IDApIHtcbiAgICAgICAgICBpbmRleCA9IHByZXZpb3VzUmVzdWx0cy5sZW5ndGggKyBpbmRleDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaXNBcnJheShwcmV2aW91c1Jlc3VsdHNbaW5kZXhdKSA/IHByZXZpb3VzUmVzdWx0c1tpbmRleF0uc2xpY2UoKSA6IHByZXZpb3VzUmVzdWx0c1tpbmRleF07XG4gICAgICB9XG4gICAgfTtcblxuICAgIGlmIChvcHRpb25zKSB7XG4gICAgICBzZWxmLm1hcChvcHRpb25zKTtcbiAgICB9XG4gIH1cblxufSkoalF1ZXJ5LCB3aW5kb3csIGRvY3VtZW50KTsiXX0=
